import{a as w,b,c as A,d as I,e as L,f as R,g as D,h as C}from"./chunk-GF7UNAXA.js";import{Fa as j,a as c,cb as E,k as U,m as l,n as x,p as g}from"./chunk-X2K52VJG.js";import{$ as h,Bc as $,S as p,Y as v,h as a}from"./chunk-V4SAOAZP.js";import{a as d,b as u}from"./chunk-CWTPBX7D.js";var k=(()=>{let e=class e{constructor(t){this.http=t}getStores(t){return this.http.get(`${c.URL}/store`,{params:t})}createStore(t){return this.http.post(`${c.URL}/store`,t)}editStore(t){return this.http.get(`${c.URL}/store/${t}`)}updateStore(t,r){return this.http.put(`${c.URL}/store/${t}`,r)}updateStoreStatus(t,r){return this.http.put(`${c.URL}/store/${t}/${r}`,{})}approveStoreStatus(t,r){return this.http.put(`${c.URL}/store/approve/${t}/${r}`,{})}deleteStore(t){return this.http.delete(`${c.URL}/store/${t}`)}deleteAllStore(t){return this.http.post(`${c.URL}/store/deleteAll`,{ids:t})}};e.\u0275fac=function(r){return new(r||e)(h($))},e.\u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"root"});let y=e;return y})();var S,i=(S=class{constructor(e,o,t){this.store=e,this.notificationService=o,this.storeService=t}static store(e){return e.store}static stores(e){return e.store.data.map(o=>({label:o?.store_name,value:o?.id}))}static selectedStore(e){return e.selectedStore}getStores(e,o){return this.storeService.getStores(o.payload).pipe(p({next:t=>{e.patchState({store:{data:t.data,total:t?.total?t?.total:t.data?.length}})},error:t=>{throw new Error(t?.error?.message)}}))}create(e,o){return this.storeService.createStore(o.payload).pipe(p({next:t=>{let r=e.getState();e.patchState(u(d({},r),{store:{data:[...r.store.data,t],total:r?.store.total+1}}))},complete:()=>{this.notificationService.showSuccess("Store Created Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}edit(e,{id:o}){return this.storeService.editStore(o).pipe(p({next:t=>{let r=e.getState();e.patchState(u(d({},r),{selectedStore:t}))},error:t=>{throw new Error(t?.error?.message)}}))}update(e,{payload:o,id:t}){return this.storeService.updateStore(t,o).pipe(p({next:r=>{if(typeof r=="object"){let s=e.getState(),n=[...s.store.data],f=n.findIndex(m=>m.id===t);n[f]=r,e.patchState(u(d({},s),{store:{data:n,total:s.store.total}}))}},complete:()=>{this.notificationService.showSuccess("Store Updated Successfully")},error:r=>{throw new Error(r?.error?.message)}}))}updateStatus(e,{id:o,status:t}){return this.storeService.updateStoreStatus(o,t).pipe(p({next:r=>{if(typeof r=="object"){let s=e.getState(),n=[...s.store.data],f=n.findIndex(m=>m.id===o);n[f]=r,e.patchState(u(d({},s),{store:{data:n,total:s.store.total}}))}},complete:()=>{this.notificationService.showSuccess("Store Status Updated Successfully")},error:r=>{throw new Error(r?.error?.message)}}))}approveStatus(e,{id:o,status:t}){return this.storeService.approveStoreStatus(o,t).pipe(p({next:r=>{if(typeof r=="object"){let s=e.getState(),n=[...s.store.data],f=n.findIndex(m=>m.id===o);n[f]=r,e.patchState(u(d({},s),{store:{data:n,total:s.store.total}})),this.store.dispatch(new E("/store",r?.total_in_approved_stores))}},complete:()=>{this.notificationService.showSuccess("Store Status Updated Successfully")},error:r=>{throw new Error(r?.error?.message)}}))}delete(e,{id:o}){return this.storeService.deleteStore(o).pipe(p({next:()=>{this.store.dispatch(new w({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Store Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}deleteAll(e,{ids:o}){return this.storeService.deleteAllStore(o).pipe(p({next:()=>{let t=e.getState(),r=t.store.data.filter(s=>!o.includes(s.id));this.store.dispatch(new w({page:1,paginate:15})),e.patchState(u(d({},t),{store:{data:r,total:t.store.total-o.length}}))},complete:()=>{this.notificationService.showSuccess("Stores Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}},S.\u0275fac=function(o){return new(o||S)(h(U),h(j),h(k))},S.\u0275prov=v({token:S,factory:S.\u0275fac}),S);a([l(w)],i.prototype,"getStores",null);a([l(b)],i.prototype,"create",null);a([l(A)],i.prototype,"edit",null);a([l(I)],i.prototype,"update",null);a([l(L)],i.prototype,"updateStatus",null);a([l(R)],i.prototype,"approveStatus",null);a([l(D)],i.prototype,"delete",null);a([l(C)],i.prototype,"deleteAll",null);a([g()],i,"store",null);a([g()],i,"stores",null);a([g()],i,"selectedStore",null);i=a([x({name:"store",defaults:{store:{data:[],total:0},selectedStore:null}})],i);export{i as a};
