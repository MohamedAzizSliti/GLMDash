import{a as Ae}from"./chunk-VTLS4DKO.js";import{A as le,Dc as be,E as pe,Fa as me,K as ce,Ua as fe,a as C,k as S,l as se,la as J,lb as he,m as x,ma as de,n as oe,o as re,p as z,qb as we,y as ne,z as ae}from"./chunk-X2K52VJG.js";import{$ as w,Bc as te,Ca as r,Da as y,Nb as v,Ob as g,Pc as ie,Qa as Y,Rb as Z,S as h,Sa as u,Sc as W,Vc as ue,Wa as T,Y as D,Z as k,ab as l,bb as p,cb as _,da as j,ea as R,gb as V,h as a,jb as M,kb as H,la as b,ma as A,rb as $,sb as F,tb as P,vc as ee,wb as f,xb as N,yb as B}from"./chunk-V4SAOAZP.js";import{a as G,b as K,f as X}from"./chunk-CWTPBX7D.js";var Q=(()=>{let e=class e{constructor(t){this.payload=t}};e.type="[Question] Get";let s=e;return s})(),ye=(()=>{let e=class e{constructor(t){this.id=t}};e.type="[Question] Edit";let s=e;return s})(),L=(()=>{let e=class e{constructor(t,i){this.payload=t,this.id=i}};e.type="[Question] put";let s=e;return s})(),U=(()=>{let e=class e{constructor(t){this.id=t}};e.type="[Question] Delete";let s=e;return s})(),O=(()=>{let e=class e{constructor(t){this.ids=t}};e.type="[Question] Delete All";let s=e;return s})();var ve=(()=>{let e=class e{constructor(t){this.http=t}getQuestionAnswers(t){return this.http.get(`${C.URL}/question-and-answer`,t)}editQuestionAnswers(t){return this.http.get(`${C.URL}/question-and-answer/${t}`)}updateQuestionAnswers(t,i){return this.http.put(`${C.URL}/question-and-answer/${t}`,i)}deleteQuestionAnswers(t){return this.http.delete(`${C.URL}/question-and-answer/${t}`)}deleteAllQuestionAnswers(t){return this.http.post(`${C.URL}/question-and-answer/deleteAll`,{ids:t})}};e.\u0275fac=function(i){return new(i||e)(w(te))},e.\u0275prov=D({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();var d,n=(d=class{constructor(e,o,t){this.store=e,this.notificationService=o,this.questionsAnswersService=t}static questionAnswers(e){return e.question}static selectedQuestionAnswers(e){return e.selectedQuestion}getQuestionAnswers(e,o){return this.questionsAnswersService.getQuestionAnswers(o.payload).pipe(h({next:t=>{e.patchState({question:{data:t.data,total:t?.total?t?.total:t.data?.length}})},error:t=>{throw new Error(t?.error?.message)}}))}edit(e,{id:o}){return this.questionsAnswersService.editQuestionAnswers(o).pipe(h({next:t=>{let i=e.getState();e.patchState(K(G({},i),{selectedQuestion:t}))},error:t=>{throw new Error(t?.error?.message)}}))}update(e,{payload:o,id:t}){return this.questionsAnswersService.updateQuestionAnswers(t,o).pipe(h({next:i=>{if(typeof i=="object"){let m=e.getState(),c=[...m.question.data],xe=c.findIndex(Qe=>Qe.id===t);c[xe]=i,e.patchState(K(G({},m),{question:{data:c,total:m.question.total}}))}},complete:()=>{this.notificationService.showSuccess("Q&A Updated Successfully")},error:i=>{throw new Error(i?.error?.message)}}))}delete(e,{id:o}){return this.questionsAnswersService.deleteQuestionAnswers(o).pipe(h({next:()=>{this.store.dispatch(new Q({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Q&A Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}deleteAll(e,{ids:o}){return this.questionsAnswersService.deleteAllQuestionAnswers(o).pipe(h({next:()=>{this.store.dispatch(new Q({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Q&A Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}},d.\u0275fac=function(o){return new(o||d)(w(S),w(me),w(ve))},d.\u0275prov=D({token:d,factory:d.\u0275fac}),d);a([x(Q)],n.prototype,"getQuestionAnswers",null);a([x(ye)],n.prototype,"edit",null);a([x(L)],n.prototype,"update",null);a([x(U)],n.prototype,"delete",null);a([x(O)],n.prototype,"deleteAll",null);a([z()],n,"questionAnswers",null);a([z()],n,"selectedQuestionAnswers",null);n=a([oe({name:"question",defaults:{question:{data:[],total:0},selectedQuestion:null}})],n);var _e=["answersModal"];function Me(s,e){if(s&1){let o=V();l(0,"div",1)(1,"h3",2),f(2),v(3,"translate"),p(),l(4,"app-button",3),M("click",function(){let i=b(o).$implicit;return A(i.dismiss("Cross click"))}),_(5,"i",4),p()(),l(6,"div",5)(7,"div",6)(8,"table",7)(9,"tbody")(10,"tr")(11,"td",8),f(12),v(13,"translate"),p(),l(14,"td",9),f(15),p()(),l(16,"tr")(17,"td",8),f(18),v(19,"translate"),p(),l(20,"td",9),_(21,"textarea",10),p()()()()(),l(22,"div")(23,"div",11)(24,"app-button",12),f(25),v(26,"translate"),p(),l(27,"app-button",13),M("click",function(){b(o);let i=H();return A(i.submit())}),f(28),v(29,"translate"),p()()()()}if(s&2){let o=H();r(2),N(g(3,17,"Answers")),r(2),T("btn btn-close"),u("spinner",!1)("id","payout_close_btn"),r(8),N(g(13,19,"Question")),r(3),B(" ",o.qna==null?null:o.qna.question," "),r(3),N(g(19,21,"Answers")),r(3),u("formControl",o.answers),r(3),T("btn-md fw-bold btn btn-secondary"),u("id","close_answers_modal_btn"),r(),B(" ",g(26,23,"Close")," "),r(2),T("btn-theme btn-md fw-bold btn"),u("id","submit_answers_btn"),r(),B(" ",g(29,25,"submit")," ")}}var Ce=(()=>{let e=class e{constructor(t,i){this.modalService=t,this.store=i,this.modalOpen=!1,this.answers=new pe("",[ae.required])}openModal(t){return X(this,null,function*(){this.modalOpen=!0,this.qna=t,t.answer?this.answers.patchValue(t.answer):this.answers.patchValue(""),this.modalService.open(this.AnswersModal,{ariaLabelledBy:"Payout-Modal",centered:!0,windowClass:"theme-modal text-center"}).result.then(i=>{`${i}`,this.closeResult=`Closed with: ${i}`},i=>{this.closeResult=`Dismissed ${this.getDismissReason(i)}`})})}getDismissReason(t){return t===J.ESC?"by pressing ESC":t===J.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${t}`}submit(){if(this.answers.markAllAsTouched(),this.answers.valid){let t={question:this.qna.question,answer:this.answers.value,product_id:this.qna.product_id};this.store.dispatch(new L(t,this.qna.id)).subscribe({complete:()=>{this.modalService.dismissAll()}})}}ngOnDestroy(){this.modalOpen&&this.modalService.dismissAll()}};e.\u0275fac=function(i){return new(i||e)(y(de),y(S))},e.\u0275cmp=j({type:e,selectors:[["app-answers-modal"]],viewQuery:function(i,m){if(i&1&&$(_e,5),i&2){let c;F(c=P())&&(m.AnswersModal=c.first)}},decls:2,vars:0,consts:[["answersModal",""],[1,"modal-header"],[1,"mb-1","fw-semibold"],[3,"click","spinner","id"],[1,"ri-close-line"],[1,"modal-body","qa-modal"],[1,"border","rounded-3","mb-4","dark-border-color"],[1,"table","all-package","theme-table","no-footer"],[1,"text-start","fw-semibold"],[1,"text-start"],["placeholder","Enter Answers",1,"form-control",3,"formControl"],[1,"button-box"],[3,"id"],[3,"click","id"]],template:function(i,m){i&1&&Y(0,Me,30,27,"ng-template",null,0,Z)},dependencies:[ne,le,ce,fe,ue]});let s=e;return s})();var Ie=["answersModal"],q=class q{constructor(e,o){this.store=e,this.router=o,this.tableConfig={columns:[{title:"No.",dataField:"no",type:"no"},{title:"Question",dataField:"question"},{title:"created_at",dataField:"created_at",type:"date",sortable:!0,sort_direction:"desc"},{title:"status",dataField:"status"}],rowActions:[{label:"Edit",actionToPerform:"edit",icon:"ri-pencil-line",permission:"store.edit"},{label:"Delete",actionToPerform:"delete",icon:"ri-delete-bin-line",permission:"store.destroy"}],data:[],total:0}}ngOnInit(){this.questionAnswers$.subscribe(e=>{let o=e.data.filter(t=>(t.status=t?.answer?'<div class="status-approved"><span>Repelled</span></div>':'<div class="status-pending"><span>Pending</span></div>',t));this.tableConfig.data=e?o:[],this.tableConfig.total=e?e?.total:0})}onTableChange(e){this.store.dispatch(new Q(e))}onActionClicked(e){e.actionToPerform=="edit"?this.AnswersModal.openModal(e.data):e.actionToPerform=="delete"?this.delete(e.data):e.actionToPerform=="deleteAll"&&this.deleteAll(e.data)}delete(e){this.store.dispatch(new U(e.id))}deleteAll(e){this.store.dispatch(new O(e))}};q.\u0275fac=function(o){return new(o||q)(y(S),y(ie))},q.\u0275cmp=j({type:q,selectors:[["app-questions-answers"]],viewQuery:function(o,t){if(o&1&&$(Ie,5),o&2){let i;F(i=P())&&(t.AnswersModal=i.first)}},decls:4,vars:4,consts:[["answersModal",""],[3,"gridClass","title"],[3,"tableChanged","action","tableConfig","hasCheckbox"]],template:function(o,t){if(o&1){let i=V();l(0,"app-page-wrapper",1)(1,"app-table",2),M("tableChanged",function(c){return b(i),A(t.onTableChange(c))})("action",function(c){return b(i),A(t.onActionClicked(c))}),p()(),_(2,"app-answers-modal",null,0)}o&2&&(u("gridClass","col-sm-12")("title","Q&A"),r(),u("tableConfig",t.tableConfig)("hasCheckbox",!0))},dependencies:[we,he,Ce]});var I=q;a([re(n.questionAnswers)],I.prototype,"questionAnswers$",void 0);var De=[{path:"",component:I}],Se=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=R({type:e}),e.\u0275inj=k({imports:[W.forChild(De),W]});let s=e;return s})();var bt=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=R({type:e}),e.\u0275inj=k({imports:[ee,Se,be,se.forFeature([n,Ae])]});let s=e;return s})();export{bt as QuestionsAnswersModule};
