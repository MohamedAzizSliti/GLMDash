import{f as Bt}from"./chunk-UG2VPS2O.js";import{a as le}from"./chunk-Q7NGHVH4.js";import{a as St,b as Nt,c as Et,d as Tt}from"./chunk-VSFJDVD2.js";import{a as Ft,h as ne}from"./chunk-FWIAH7KG.js";import{a as se,c as Mt,d as _e}from"./chunk-5IDY52IY.js";import{a as kt}from"./chunk-SYLZCP4O.js";import{a as At,c as Pt,f as Dt}from"./chunk-IJGVJEQP.js";import{a as ht}from"./chunk-XA3FHL27.js";import{a as re}from"./chunk-NEHVOI7D.js";import{a as ft}from"./chunk-GF7UNAXA.js";import{a as _t}from"./chunk-JHPC47PJ.js";import{a as z}from"./chunk-VLZOTMR3.js";import{a as L,b as gt,c as vt,d as bt,e as Ct,f as yt,g as he,h as xt,i as wt,j as Vt,l as It,m as M}from"./chunk-O55BQOZL.js";import{a as ae}from"./chunk-ISOQKGNC.js";import{A as Oe,B as $e,Bc as ct,C as q,Dc as ut,E as m,G as Ge,Ga as ee,Gb as st,H as Re,L as je,M as ze,Mb as oe,O as Le,Oa as te,T as Qe,Ua as tt,aa as fe,ab as it,ba as Ue,ca as We,fb as ot,ic as pt,k as Z,l as Pe,lb as O,o as I,oa as Ke,pa as He,qa as Je,qb as rt,ra as Ye,rb as at,rc as dt,sa as Xe,sc as mt,ta as Ze,ua as et,x as De,xb as lt,y as qe,yb as nt,z as ue}from"./chunk-X2K52VJG.js";import{C as Ce,Ca as o,Da as y,Db as Ve,Eb as Ie,Fb as Se,Ia as we,Ib as E,Nb as p,Nc as ke,Ob as d,P as ye,Pc as X,Q as xe,Qa as g,Qc as Ae,Rb as me,Sa as l,Sc as ce,Ua as k,Vc as ie,Xa as de,Z as W,ab as s,bb as n,bc as Ne,c as pe,cb as c,da as F,db as H,ea as K,eb as J,gb as T,h as V,j as ve,jb as x,jc as Ee,kb as _,kc as Te,la as b,ma as C,nb as v,nc as Fe,o as j,q as be,rb as A,rc as Me,sb as P,tb as D,ub as Y,vc as Be,wb as h,xb as N,yb as S}from"./chunk-V4SAOAZP.js";import{f as ge}from"./chunk-CWTPBX7D.js";var Jt=["csvModal"],Yt=()=>["/vehicle/create"];function Xt(a,e){if(a&1){let t=T();s(0,"div",5)(1,"a",6),x("click",function(){b(t);let r=_();return C(r.CSVModal.openModal())}),c(2,"i",7),h(3),p(4,"translate"),n(),s(5,"a",6),x("click",function(){b(t);let r=_();return C(r.export())}),c(6,"i",8),h(7),p(8,"translate"),n(),s(9,"a",9),c(10,"i",10),h(11),p(12,"translate"),n()()}a&2&&(o(3),S(" ",d(4,4,"Import")," "),o(4),S(" ",d(8,6,"Export")," "),o(2),l("routerLink",E(10,Yt)),o(2),S(" ",d(12,8,"add_vehicle")," "))}var $=class ${constructor(e,t,i){this.store=e,this.vehicleService=t,this.router=i,this.vehicles=[],this.tableConfig={columns:[{title:"No.",dataField:"no",type:"no"},{title:"image",dataField:"vehicle_thumbnail",class:"tbl-image",type:"image",placeholder:"assets/images/product.png"},{title:"title",dataField:"title",sortable:!0,sort_direction:"desc"},{title:"conducteur",dataField:"driver.name",sortable:!0,sort_direction:"desc"},{title:"IMEI device",dataField:"device.imei",sortable:!0,sort_direction:"desc"},{title:"immatriculation",dataField:"immatriculation"},{title:"phone",dataField:"driver.phone"},{title:"status",dataField:"status",type:"switch"},{title:"Connected",dataField:"isConnected"},{title:"Current adresse",dataField:"adresse"}],rowActions:[{label:"Edit",actionToPerform:"edit",icon:"ri-pencil-line",permission:"vehicle.edit"},{label:"Delete",actionToPerform:"delete",icon:"ri-delete-bin-line",permission:"vehicle.destroy"},{label:"Action",actionToPerform:"action",icon:"ri-flashlight-fill",permission:"vehicle.destroy"}],data:[],total:0},this.firstCall=!0,this.user$.subscribe(r=>{r.role?.name!=="vendor"&&r.role?.name!=="consumer"&&(this.firstCall&&this.tableConfig.columns?.push({title:"Soci\xE9t\xE9",dataField:"user.name"}),this.firstCall=!1)})}ngOnInit(){this.vehicle$.subscribe(e=>{let t=e?.data?.filter(i=>(console.log("/***** The Value elementelementelementelementelementelementelement****/"),console.log(i),i&&(i.isConnected=i?.device?.info_traccar&&i?.device?.info_traccar?.status=="online"?'<img class="isConnected" style="width=30px !important; "  src="assets/images/valid.png">':'<img class="isConnected" style="width=30px !important;" src="assets/images/no-valid.png">',i.adresse=i?.device?.info_traccar&&i?.device?.info_traccar?.status=="online"?i?.device?.info_traccar?.position.adresse:"____________"),i));this.tableConfig.data=e?t:[],this.tableConfig.total=e?e?.total:0})}onTableChange(e){this.store.dispatch(new L(e))}onActionClicked(e){e.actionToPerform=="edit"?this.edit(e.data):e.actionToPerform=="is_approved"?this.approve(e.data):e.actionToPerform=="status"?this.status(e.data):e.actionToPerform=="delete"?this.delete(e.data):e.actionToPerform=="action"?this.action(e.data):e.actionToPerform=="deleteAll"?this.deleteAll(e.data):e.actionToPerform=="duplicate"&&this.duplicate(e.data)}edit(e){this.router.navigateByUrl(`/vehicle/edit/${e.id}`)}approve(e){this.store.dispatch(new yt(e.id,e.is_approved))}status(e){this.store.dispatch(new Ct(e.id,e.status))}delete(e){this.store.dispatch(new he(e.id))}action(e){this.store.dispatch(new he(e.id))}deleteAll(e){this.store.dispatch(new xt(e))}duplicate(e){this.store.dispatch(new wt(e))}export(){this.store.dispatch(new Vt)}};$.\u0275fac=function(t){return new(t||$)(y(Z),y(It),y(X))},$.\u0275cmp=F({type:$,selectors:[["app-vehicles"]],viewQuery:function(t,i){if(t&1&&A(Jt,5),t&2){let r;P(r=D())&&(i.CSVModal=r.first)}},decls:5,vars:7,consts:[["csvModal",""],[3,"gridClass","title"],["class","d-flex flex-wrap gap-2","button","",4,"hasPermission"],[3,"tableChanged","rowClicked","action","tableConfig","hasCheckbox","hasDuplicate"],[3,"module"],["button","",1,"d-flex","flex-wrap","gap-2"],["href","javascript:void(0)",1,"align-items-center","btn","btn-outline","me-2",3,"click"],[1,"ri-upload-2-line"],[1,"ri-download-2-line"],[1,"align-items-center","btn","btn-theme","d-flex",3,"routerLink"],[1,"ri-add-line"]],template:function(t,i){if(t&1){let r=T();s(0,"app-page-wrapper",1),g(1,Xt,13,11,"div",2),s(2,"app-table",3),x("tableChanged",function(f){return b(r),C(i.onTableChange(f))})("rowClicked",function(f){return b(r),C(i.edit(f))})("action",function(f){return b(r),C(i.onActionClicked(f))}),n()(),c(3,"app-import-csv-modal",4,0)}t&2&&(l("gridClass","col-sm-12")("title","vehicles"),o(),l("hasPermission","vehicle.create"),o(),l("tableConfig",i.tableConfig)("hasCheckbox",!0)("hasDuplicate",!0),o(),l("module","product"))},dependencies:[Ae,rt,O,ct,it,ie]});var G=$;V([I(M.vehicle)],G.prototype,"vehicle$",void 0);V([I(ee.user)],G.prototype,"user$",void 0);var Zt=["nav"],ei=["adresseInput"],ti=["marker"],B=()=>[],ii=()=>({draggable:!0});function oi(a,e){a&1&&(s(0,"div",43),h(1),p(2,"translate"),n()),a&2&&(o(),S(" ",d(2,1,"name_is_required")," "))}function ri(a,e){if(a&1){let t=T();H(0),s(1,"app-form-fields",27)(2,"select2",44),p(3,"translate"),p(4,"translate"),p(5,"async"),p(6,"async"),x("update",function(r){b(t);let u=_(2);return C(u.selectBrand(r))}),n()(),s(7,"app-form-fields",27),c(8,"select2",45),p(9,"translate"),p(10,"translate"),p(11,"async"),p(12,"async"),n(),J()}if(a&2){let t,i,r=_(2);o(),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","Marque")("for","name")("required",!0),o(),v("noResultMessage",d(3,16,"no_data_found")),l("placeholder",d(4,18,"select_brand"))("data",(t=d(5,20,r.brands$))!=null&&t.length?d(6,22,r.brands$):E(32,B)),o(5),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","Model")("for","name")("required",!0),o(),v("noResultMessage",d(9,24,"no_data_found")),l("placeholder",d(10,26,"select_model"))("data",(i=d(11,28,r.models$))!=null&&i.length?d(12,30,r.models$):E(33,B))}}function ai(a,e){if(a&1&&(s(0,"app-form-fields",27),c(1,"select2",46),p(2,"translate"),p(3,"translate"),n()),a&2){let t=_(2);l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","carburant")("for","store")("required",!0),o(),v("noResultMessage",d(2,8,"no_data_found")),l("placeholder",d(3,10,"select_carburant"))("data",t.typeCarburant!=null&&t.typeCarburant.length?t.typeCarburant:E(12,B))}}function li(a,e){a&1&&(s(0,"div",43),h(1),p(2,"translate"),n()),a&2&&(o(),S(" ",d(2,1,"name_is_required")," "))}function ni(a,e){a&1&&(s(0,"div",43),h(1),p(2,"translate"),n()),a&2&&(o(),S(" ",d(2,1,"description_is_required")," "))}function si(a,e){if(a&1&&(s(0,"div",25)(1,"div",26)(2,"app-form-fields",27),c(3,"input",28),g(4,oi,3,3,"div",29),n(),s(5,"app-form-fields",27),c(6,"select2",30),p(7,"translate"),p(8,"translate"),n(),g(9,ri,13,34,"ng-container",31),s(10,"app-form-fields",27),c(11,"input",32),p(12,"translate"),n(),g(13,ai,4,13,"app-form-fields",33),p(14,"async"),p(15,"async"),s(16,"app-form-fields",27)(17,"div",34),c(18,"input",35),p(19,"translate"),s(20,"span",36),h(21," L \xE0 100 Klm "),n()(),g(22,li,3,3,"div",29),n(),s(23,"app-form-fields",27),c(24,"select2",37),p(25,"translate"),p(26,"translate"),s(27,"p",38),h(28),p(29,"translate"),n()(),s(30,"app-form-fields",27)(31,"div",34),c(32,"input",39),p(33,"translate"),s(34,"span",36),h(35," Klm/h "),n()(),s(36,"p",38),h(37),p(38,"translate"),n()(),s(39,"app-form-fields",27)(40,"div",40),c(41,"ngx-editor-menu",41)(42,"ngx-editor",42),g(43,ni,3,3,"div",29),n()()()()),a&2){let t,i=_();o(2),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","title")("for","name")("required",!0),o(),v("placeholder","Enter vehicle name"),o(),l("ngIf",(i.form.get["voiture.title"]==null?null:i.form.get["voiture.title"].touched)&&(i.form.get["voiture.title"].errors==null?null:i.form.get["voiture.title"].errors.required)),o(),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","categories")("for","store")("required",!0),o(),v("noResultMessage",d(7,56,"no_data_found")),l("placeholder",d(8,58,"select_category"))("data",i.categoryVehicle!=null&&i.categoryVehicle.length?i.categoryVehicle:E(78,B)),o(3),l("ngIf",i.selectedCategory=="voiture"),o(),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","plate")("for","name")("required",!0),o(),v("placeholder",d(12,60,"enter_plate")),o(2),l("ngIf",((t=d(14,62,i.setting$))==null||t.activation==null?null:t.activation.multivendor)&&((t=d(15,64,i.user$))==null||t.role==null?null:t.role.name)==="admin"),o(3),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","coso_moy_carburant")("for","name")("required",!0),o(2),v("placeholder",d(19,66,"coso_moy_carburant_placeholder")),o(4),l("ngIf",(i.form.get["voiture.coso_moy_carburant"]==null?null:i.form.get["voiture.coso_moy_carburant"].touched)&&(i.form.get["voiture.coso_moy_carburant"].errors==null?null:i.form.get["voiture.coso_moy_carburant"].errors.required)),o(),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","color")("for","store")("required",!1),o(),v("noResultMessage",d(25,68,"no_data_found")),l("placeholder",d(26,70,"select_color"))("data",i.colors!=null&&i.colors.length?i.colors:E(79,B)),o(4),N(d(29,72,"help_text_color")),o(2),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","speed_max")("for","speed_max")("required",!0),o(2),v("placeholder",d(33,74,"enter_speed_max_vehicule")),o(5),N(d(38,76,"enter_speed_max_help_vehicule")),o(2),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","description")("for","description")("required",!0),o(2),l("editor",i.editor),o(),l("editor",i.editor)("ngModel",i.html)("placeholder","Type here..."),o(),l("ngIf",(i.form.get["voiture.description"]==null?null:i.form.get["voiture.description"].touched)&&(i.form.get["voiture.description"]==null||i.form.get["voiture.description"].errors==null?null:i.form.get["voiture.description"].errors.required))}}function pi(a,e){if(a&1&&(s(0,"div",57)(1,"div",58),c(2,"div"),n(),s(3,"span",59),h(4),n()()),a&2){let t=e.data;o(2),de("iti-flag ",t==null?null:t.class,""),o(2),N(t.code)}}function di(a,e){a&1&&(s(0,"div",43),h(1),p(2,"translate"),n()),a&2&&(o(),S(" ",d(2,1,"enter_valid_email")," "))}function mi(a,e){if(a&1&&(s(0,"div",47)(1,"div",48)(2,"app-form-fields",27),c(3,"input",49),p(4,"translate"),n(),s(5,"app-form-fields",27)(6,"select2",50),p(7,"translate"),g(8,pi,5,4,"ng-template",null,1,me),n(),c(10,"input",51),p(11,"translate"),n(),s(12,"app-form-fields",27),c(13,"input",52),p(14,"translate"),g(15,di,3,3,"div",29),n(),s(16,"app-form-fields",27)(17,"div",53)(18,"label",54),c(19,"input",55)(20,"span",56),n()()()()()),a&2){let t=Y(9),i=_();o(2),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","name")("for","unit")("required",!1),o(),v("placeholder",d(4,27,"enter_name")),o(2),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","phone")("for","phone")("required",!0),o(),v("noResultMessage",d(7,29,"no_data_found")),l("templates",t)("data",i.codes),o(4),v("placeholder",d(11,31,"enter_phone")),o(2),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","email")("for","email")("required",!0),o(),v("placeholder",d(14,33,"enter_email")),o(2),l("ngIf",(i.form.get["user.email_user"]==null?null:i.form.get["user.email_user"].touched)&&(i.form.get["user.email_user"]==null||i.form.get["user.email_user"].errors==null?null:i.form.get["user.email_user"].errors.email_user)),o(),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","jeune_conducteur")("for","is_sale_enable")("required",!1)}}function ci(a,e){if(a&1&&(s(0,"div",57)(1,"div",58),c(2,"div"),n(),s(3,"span",59),h(4),n()()),a&2){let t=e.data;o(2),de("iti-flag ",t==null?null:t.class,""),o(2),N(t.code)}}function ui(a,e){a&1&&(s(0,"div",43),h(1),p(2,"translate"),n()),a&2&&(o(),S(" ",d(2,1,"phone_number_is_invalid")," "))}function fi(a,e){a&1&&(s(0,"div",43),h(1),p(2,"translate"),n()),a&2&&(o(),S(" ",d(2,1,"phone_is_required")," "))}function hi(a,e){if(a&1){let t=T();s(0,"google-map",73,3)(2,"map-marker",74,4),x("mapDragend",function(r){b(t);let u=_(2);return C(u.onMarkerDragEnd(r))}),n()()}if(a&2){let t=_(2);l("center",t.center)("zoom",t.zoom)("options",t.options),o(2),l("position",t.center)("draggable",!0)("options",E(6,ii))}}function _i(a,e){if(a&1){let t=T();s(0,"div",60)(1,"div",61)(2,"app-form-fields",27),c(3,"input",62),p(4,"translate"),n(),s(5,"app-form-fields",27)(6,"select2",50),p(7,"translate"),g(8,ci,5,4,"ng-template",null,1,me),n(),c(10,"input",63),p(11,"translate"),g(12,ui,3,3,"div",29)(13,fi,3,3,"div",29),n(),s(14,"app-form-fields",27),c(15,"input",64),p(16,"translate"),n(),s(17,"app-form-fields",27)(18,"app-advanced-dropdown",65),p(19,"async"),p(20,"async"),x("selectedItem",function(r){b(t);let u=_();return C(u.selectTagItem(r))}),n()(),s(21,"app-form-fields",66),p(22,"translate"),s(23,"div",34),c(24,"input",67,2),p(26,"translate"),s(27,"span",68),x("click",function(){b(t);let r=_();return C(r.getCurrentLocation())}),c(28,"i",69),n()(),s(29,"p",38),h(30),p(31,"translate"),n()(),s(32,"div",7),c(33,"div",70)(34,"div",71),n(),g(35,hi,4,7,"google-map",72),n()()}if(a&2){let t,i,r,u=Y(9),f=_();o(2),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","imei")("for","categories")("required",!0),o(),v("placeholder",d(4,39,"enter_imei")),o(2),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","phone")("for","phone")("required",!0),o(),v("noResultMessage",d(7,41,"no_data_found")),l("templates",u)("data",f.codes),o(4),v("placeholder",d(11,43,"enter_phone")),o(2),l("ngIf",((t=f.form.get("device.phone_device"))==null?null:t.touched)&&((t=f.form.get("device.phone_device"))==null||t.errors==null?null:t.errors.pattern)),o(),l("ngIf",((i=f.form.get("device.phone_device"))==null?null:i.touched)&&((i=f.form.get("device.phone_device"))==null||i.errors==null?null:i.errors.required)),o(),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","operator")("for","categories")("required",!0),o(),v("placeholder",d(16,45,"enter_operator")),o(2),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","groupes")("for","tags")("required",!1),o(),l("position","bottom")("selectedOption",f.selectedTags)("options",!((r=d(19,47,f.tag$))==null||r.data==null)&&r.data.length?(r=d(20,49,f.tag$))==null?null:r.data:E(57,B)),o(3),l("label",d(22,51,"adresse"))("for","value")("required",!1)("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9"),o(3),v("placeholder",d(26,53,"adresse")),o(6),N(d(31,55,"help_text_first_position")),o(5),l("ngIf",f.visible)}}function gi(a,e){if(a&1){let t=T();s(0,"div",75)(1,"app-form-fields",27)(2,"app-image-upload",76),p(3,"async"),x("selectedFiles",function(r){b(t);let u=_();return C(u.selectThumbnail(r))}),n()(),s(4,"app-form-fields",27)(5,"app-image-upload",77),p(6,"async"),x("selectedFiles",function(r){b(t);let u=_();return C(u.selectImages(r))}),n()(),s(7,"app-form-fields",27)(8,"app-image-upload",76),p(9,"async"),x("selectedFiles",function(r){b(t);let u=_();return C(u.selectSizeImage(r))}),n()()()}if(a&2){let t,i,r,u=_();o(),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","thumbnail")("for","vehicle_thumbnail_id")("required",!1),o(),l("multipleImage",!1)("image",(t=d(3,24,u.vehicle$))==null?null:t.vehicle_thumbnail)("helpText","*Upload image size 600x600px recommended"),o(2),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","images")("for","vehicle_galleries_id")("required",!1),o(),l("multipleImage",!0)("images",(i=d(6,26,u.vehicle$))==null?null:i.vehicle_galleries)("helpText","*Upload image size 600x600px recommended"),o(2),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label","Size Chart")("for","size_chart_image_id")("required",!1),o(),l("multipleImage",!1)("image",(r=d(9,28,u.vehicle$))==null?null:r.size_chart_image)("helpText","*Upload an image showcasing the size chart tailored for fashion vehicles. A table format image is suggested for easy reference.")}}function vi(a,e){if(a&1){let t=T();H(0),s(1,"app-form-fields",27)(2,"div",53)(3,"label",54)(4,"input",81),x("change",function(r){let u=b(t).$implicit,f=_(3);return C(f.changeCheckBox(r,u.key))}),n(),c(5,"span",56),n(),s(6,"app-advanced-dropdown",82),x("selectedItem",function(r){let u=b(t).$implicit,f=_(3);return C(f.selectMthodeNotif(r,u.key))}),n()()(),J()}if(a&2){let t=e.$implicit,i=_(3);o(),l("labelClass","form-label-title col-sm-3 mb-0")("gridClass","col-sm-9")("label",t.key)("for","vehicle_featured")("required",!1),o(3),v("formControlName",t.key),o(2),l("position","bottom")("selectedOption",t==null?null:t.value.methods)("hidden",i.methodNotif.result_cmd.disabled)("options",i.notification_methode!=null&&i.notification_methode.length?i.notification_methode:E(10,B))}}function bi(a,e){if(a&1&&(H(0),g(1,vi,7,11,"ng-container",80),p(2,"keyvalue"),J()),a&2){let t=_(2);o(),l("ngForOf",d(2,1,t.defaultParmsNotif==null?null:t.defaultParmsNotif.methodes_notif))}}function Ci(a,e){if(a&1&&(s(0,"div",78)(1,"div",79),g(2,bi,3,3,"ng-container",31),n()()),a&2){let t=_();o(2),l("ngIf",t.defaultParmsNotif)}}var R=class R{constructor(e,t,i,r,u,f,U,jt,zt,Lt,Qt){this.store=e,this.route=t,this.gmaps=i,this.modelService=r,this.router=u,this.formBuilder=f,this.calendar=U,this.formatter=jt,this.renderer=zt,this.accessDataService=Lt,this.document=Qt,this.active="general",this.selectedCategories=[],this.selectedTags=[],this.variationCombinations=[],this.retrieveVariants=!1,this.variantCount=0,this.hoveredDate=null,this.destroy$=new pe,this.html="",this.notification_methode=Bt,this.selectedMethodeNotif=[1,2,3],this.vehicleType=[{value:"simple",label:"Simple"},{value:"classified",label:"Classified"}],this.geocoder=new google.maps.Geocoder,this.categoryVehicle=[{value:"voiture",label:"Voiture"},{value:"moto",label:"Moto"},{value:"velo",label:"V\xE9lo"},{value:"animal",label:"Animale"},{value:"avion",label:"Avion"},{value:"bateau",label:"Bateau"},{value:"trottinette",label:"Trottinette"}],this.typeCarburant=[{value:"diesel",label:"Diesel"},{value:"essence",label:"Essence"},{value:"electric",label:"Electrique"}],this.colors=[{value:"white",label:"White"},{value:"black",label:"Black"},{value:"yellow",label:"Yellow"},{value:"green",label:"Green"},{value:"red",label:"red"},{value:"bleu",label:"Bleu"},{value:"gray",label:"Gray"},{value:"gold",label:"Gold"},{value:"brown",label:"Brown"},{value:"purple",label:"Purple"},{value:"violet",label:"Violet"}],this.tabNotifIsClicked=!1,this.stocks=[{value:"in_stock",label:"In Stock"},{value:"out_of_stock",label:"Out of Stock"}],this.filter={search:"",paginate:15,ids:"",with_union_vehicles:0,is_approved:1},this.variants=[{id:null,attribute_values:null,options:null,variant_option:null}],this.variations=[],this.search=new pe,this.codes=_t,this.methodNotif={result_cmd:{methods:[1,2,3],disabled:!1},deviceOnline:{methods:[1,2,3],disabled:!1},deviceOffline:{methods:[1,2,3],disabled:!1},deviceMoving:{methods:[1,2,3],disabled:!1},deviceIdle:{methods:[1,2,3],disabled:!1},deviceStopped:{methods:[1,2,3],disabled:!1},deviceOverspeed:{methods:[1,2,3,4],disabled:!1},deviceFuelDrop:{methods:[1,2,3],disabled:!1},deviceFuelIncrease:{methods:[1,2,3],disabled:!1},geofenceEnter:{methods:[1,2,3],disabled:!1},geofenceExit:{methods:[1,2,3,4],disabled:!1},deviceAlarm:{methods:[1,2,3],disabled:!1},contact_mis:{methods:[1,2,3],disabled:!1},contact_coupe:{methods:[1,2,3],disabled:!1},deviceMaintenance:{methods:[1,2,3],disabled:!1},received_msg:{methods:[1,2,3],disabled:!1},driver_change:{methods:[1,2,3],disabled:!1},remorquage:{methods:[1,2,3,4],disabled:!1},derapage_fort:{methods:[1,2,3,4],disabled:!1}},this.latitude=36.8065,this.longitude=10.1815,this.options={mapTypeId:"roadmap",disableDefaultUI:!1},this.center={lat:36.8065,lng:10.1815},this.zoom=12,this.visible=!1,this.defaultParmsNotif=null,this.store.dispatch(new ft({status:1,is_approved:1})),this.store.dispatch(new dt({status:1})),this.store.dispatch(new mt({status:1})),this.store.dispatch(new st({type:"vehicle",status:1})),this.store.dispatch(new pt({type:"vehicle",status:1})),this.store.dispatch(new Ft({status:1})),this.attribute$=this.store.select(z.attributes).pipe(j(Ut=>Ut(""))),this.form=this.formBuilder.group({voiture:new q({title:new m(""),description:new m(""),brand_id:new m,model_id:new m,carburant:new m("diesel"),color:new m("white"),speed_max:new m(null),coso_moy_carburant:new m(6),type:new m("voiture"),immatriculation:new m,category:new m}),photos:new q({vehicle_galleries_id:new m(""),vehicle_thumbnail_id:new m(""),size_chart_image_id:new m("")}),user:new q({email:new m(""),firstname_user:new m,country_code:new m("216"),lastname_user:new m,email_user:new m,is_young_driver:new m,phone_user:new m("")}),device:new q({phone_device:new m(""),country_code:new m("216"),external_button_text:new m,imei:new m,laltitude:new m,adresse:new m,longtitude:new m,operator:new m}),notifications:new q({result_cmd:new m(1),deviceOnline:new m(1),deviceIdle:new m(1),deviceMoving:new m(1),categories:new m(""),is_random_related_vehicles:new m(0),deviceStopped:new m(1),cross_sell_vehicles:new m([]),deviceOverspeed:new m(1),deviceFuelDrop:new m(1),deviceFuelIncrease:new m(1),geofenceEnter:new m(1),geofenceExit:new m(1),deviceAlarm:new m(1),contact_mis:new m(1),variants:this.formBuilder.array([],[]),variations:this.formBuilder.array([],[]),attributes_ids:new m([]),contact_coupe:new m(1),deviceMaintenance:new m(1),received_msg:new m(1),driver_change:new m(1),remorquage:new m(1),derapage_fort:new m(1),status:new m(1),deviceOffline:new m(1),methodes_notif:new m(1)})}),this.copyMethodNotif=JSON.parse(JSON.stringify(this.methodNotif)),this.loadParamsNotif()}loadParamsNotif(){this.accessDataService.getData(null,"/vehicle/notif/params").subscribe(e=>{if(this.defaultParmsNotif=e,console.log("defaultParmsNotif:",this.defaultParmsNotif),this.defaultParmsNotif&&Object.keys(this.defaultParmsNotif.methodes_notif).length>0){let t=Object.keys(this.defaultParmsNotif.methodes_notif),i=this.form.get("notifications");i?t.forEach(r=>{i.controls[r]?(console.log("/***** The Value ****/"),console.log(this.defaultParmsNotif.methodes_notif[r]?.disabled),console.log(r),console.log(this.defaultParmsNotif[r]),i.controls[r].setValue(this.defaultParmsNotif[r])):console.warn(`Cl\xE9 '${r}' non trouv\xE9e dans notificationsGroup`)}):console.error("Le FormGroup 'notifications' est introuvable.")}},e=>{},()=>{})}initializeAutocomplete(){let e=document.getElementById("address");this.autocomplete=new google.maps.places.Autocomplete(e),this.autocomplete.addListener("place_changed",()=>{let t=this.autocomplete.getPlace();t.geometry&&(this.latitude=t.geometry.location.lat(),this.longitude=t.geometry.location.lng(),this.center={lat:this.latitude,lng:this.longitude},this.zoom=17)})}ngOnInit(){this.loadMap(),this.search.pipe(Ce(300)).subscribe(e=>{this.filter.search=e,this.store.dispatch(new L(this.filter))}),this.form.controls.device.controls.imei.valueChanges.subscribe(e=>{let t=this.form.controls.device.controls.phone_device;e?t?.setValidators([ue.required]):t?.clearValidators(),t?.updateValueAndValidity()}),this.route.params.pipe(ye(e=>e.id?(this.models$=this.store.select(_e.models).pipe(j(t=>t(null))),this.store.dispatch(new vt(e.id)).pipe(be(()=>this.store.select(M.selectedVehicle)))):ve()),xe(this.destroy$)).subscribe(e=>{if(e?.related_vehicles&&e?.cross_sell_vehicles){let t=[...e?.related_vehicles,...e?.cross_sell_vehicles];this.filter.paginate=t?.length>=15?t?.length:15,this.filter.ids=t?.join(),this.filter.with_union_vehicles=t?.length?t?.length>=15?0:1:0}this.store.dispatch(new L(this.filter)).subscribe({next:()=>{this.id=e?.id;let t={};e.notifs&&e.notifs.forEach((i,r)=>{this.methodNotif[i.libelle].methods=i.pivot.method?.split(","),t[i.libelle]=this.checkAlert(e.notifs,i.libelle),this.methodNotif[i.libelle].disabled=!t[i.libelle]},this),console.log("/***** The Value notifsnotifsnotifsnotifs****/"),console.log(t),this.form.patchValue({voiture:{title:e?.title,brand_id:e?.brand_id,model_id:e?.model_id,type:e?.type,color:e?.color,speed_max:e?.speed_max,coso_moy_carburant:e?.coso_moy_carburant,carburant:e?.carburant,immatriculation:e?.immatriculation},device:{phone_device:e?.device?.phone,country_code:"216",imei:e?.device?.imei,operator:e?.device?.operator},user:{email:e?.driver?.email,firstname_user:e?.driver?.name,country_code:"216",lastname_user:"",email_user:e?.driver?.email,is_young_driver:e?.driver?.is_young_driver,phone_user:e?.driver?.phone},notifications:t})}})}),this.editor=new Tt}get selectedCategory(){return this.form.get("voiture.type")?.value}loadMap(){return ge(this,null,function*(){let e=this,t=yield this.gmaps.loadGoogleMap();this.googleMaps=t,this.visible=!0,setTimeout(()=>{if(this.marker){let i=this.googleMaps.event.addListener(this.marker,"dragend",()=>{console.log("/***** The Value ****/"),console.log("fefeefef")})}}),this.initializeAutocomplete()})}searchVehicle(e){this.search.next(e.search)}getAttributeValues(e){return this.store.select(z.attribute_value).pipe(j(t=>t(e||null)))}isHovered(e){return this.fromDate&&!this.toDate&&this.hoveredDate&&e.after(this.fromDate)&&e.before(this.hoveredDate)}isInside(e){return this.toDate&&e.after(this.fromDate)&&e.before(this.toDate)}isRange(e){return e.equals(this.fromDate)||this.toDate&&e.equals(this.toDate)||this.isInside(e)||this.isHovered(e)}validateInput(e,t){let i=this.formatter.parse(t);return i&&this.calendar.isValid(fe.from(i))?fe.from(i):e}updateAttributeValue(e,t){this.form.get("variants").at(t).patchValue({options:e?.options})}selectTagItem(e){Array.isArray(e)&&this.form.controls.tags.setValue(Array.isArray(e)?e:[])}selectThumbnail(e){Array.isArray(e)||this.form.controls.photos.controls.vehicle_thumbnail_id.setValue(e?e.id:null)}selectImages(e){let t=Array.isArray(e)?e?.map(i=>i.id):[];this.form.controls.photos.controls.vehicle_galleries_id.setValue(t)}selectSizeImage(e){Array.isArray(e)||this.form.controls.photos.controls.size_chart_image_id.setValue(e?e.id:null)}submit(){this.form.markAllAsTouched(),this.form.controls.notifications.controls.methodes_notif.setValue(this.copyMethodNotif),this.form.controls.device.controls.longtitude.setValue(this.longitude),this.form.controls.device.controls.laltitude.setValue(this.latitude);let e=new gt(this.form.value);if(this.type=="edit"&&this.id&&(this.form.addControl("tabNotifIsClicked",this.formBuilder.control(this.tabNotifIsClicked,ue.required)),e=new bt(this.form.value,this.id)),this.form.valid)this.store.dispatch(e).subscribe({complete:()=>{this.form.controls.photos.controls.vehicle_thumbnail_id.setValue(""),this.form.controls.photos.controls.vehicle_galleries_id.setValue(""),this.router.navigateByUrl("/vehicle")}}),this.tabError=null;else{let t=Object?.keys(this.form?.controls).find(r=>this.form.controls[r].invalid),i=document.querySelector(`#${t}`)?.closest("div.tab")?.getAttribute("tab");i&&(this.nav.select(i),this.tabError=i)}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}selectBrand(e){e&&e?.value?this.models$=this.store.select(_e.models).pipe(j(t=>t(+e?.value))):this.form.controls.voiture.controls.model_id.setValue("")}checkAlert(e,t){let i=e.find(r=>r.libelle===t);return i?i.pivot.alert===1:!1}selectMthodeNotif(e,t=null){Array.isArray(e),t&&Array.isArray(e)&&(this.copyMethodNotif[t].methods=e)}onTabChange(e){e=="status"&&(this.tabNotifIsClicked=!0)}getCurrentLocation(){let e=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{this.latitude=t.coords.latitude,this.longitude=t.coords.longitude,this.center={lat:this.latitude,lng:this.longitude},this.zoom=17;let i=this.latitude,r=this.longitude;this.geocoder.geocode({location:{lat:i,lng:r}},(u,f)=>{if(f==="OK"&&u[0]){let U=u[0].formatted_address;console.log("Adresse obtenue :",U),this.adresseInput.nativeElement.value=U}else console.error("Impossible de trouver une adresse :",f)})}):alert("La g\xE9olocalisation n\u2019est pas support\xE9e par ce navigateur.")}changeCheckBox(e,t){this.methodNotif[t].disabled=!e.target.checked}onMarkerDragEnd(e){console.log("/***** The Value eventhhh ****/"),console.log(e),e.latLng&&(this.center={lat:e.latLng.lat(),lng:e.latLng.lng()},this.getAddress(this.center.lat,this.center.lng))}getAddress(e,t){let i=new google.maps.Geocoder,r=new google.maps.LatLng(e,t);i.geocode({location:r},(u,f)=>{f===google.maps.GeocoderStatus.OK&&u[0]?this.form.controls.device.controls.adresse.setValue(u[0].formatted_address):this.form.controls.device.controls.adresse.setValue("Address not found")})}};R.\u0275fac=function(t){return new(t||R)(y(Z),y(ke),y(kt),y(Mt),y(X),y(Qe),y(Ue),y(We),y(we),y(ht),y(Ne))},R.\u0275cmp=F({type:R,selectors:[["app-form-vehicle"]],viewQuery:function(t,i){if(t&1&&(A(Zt,5),A(ei,5),A(ti,5)),t&2){let r;P(r=D())&&(i.nav=r.first),P(r=D())&&(i.adresseInput=r.first),P(r=D())&&(i.marker=r.first)}},inputs:{type:"type"},decls:41,vars:32,consts:[["nav","ngbNav"],["template",""],["adresseInput",""],["googleMap",""],["marker",""],[1,"theme-form","theme-form-2","mega-form",3,"ngSubmit","formGroup"],[1,"vertical-tabs"],[1,"row"],[1,"col-xl-3","col-lg-4"],["ngbNav","","orientation","vertical",1,"nav-pills",3,"activeIdChange","activeId"],["ngbNavItem","general","id","general"],["ngbNavLink",""],[1,"ri-settings-line"],["ngbNavContent",""],["ngbNavItem","inventory","id","inventory"],[1,"ri-file-list-line"],["ngbNavItem","setup","id","setup"],[1,"ri-tools-line"],["ngbNavItem","images","id","images"],[1,"ri-image-line"],["ngbNavItem","status","id","status"],[1,"ri-checkbox-circle-line"],[1,"col-xl-7","col-lg-8"],[3,"ngbNavOutlet"],[3,"id"],["tab","general",1,"tab"],["formGroupName","voiture"],[3,"labelClass","gridClass","label","for","required"],["id","name","type","text","formControlName","title",1,"form-control",3,"placeholder"],["class","invalid-feedback",4,"ngIf"],["formControlName","type","id","store_id","resettable","",1,"custom-select",3,"placeholder","data","noResultMessage"],[4,"ngIf"],["id","name","type","text","formControlName","immatriculation",1,"form-control",3,"placeholder"],[3,"labelClass","gridClass","label","for","required",4,"ngIf"],[1,"input-group"],["id","name","type","text","formControlName","coso_moy_carburant",1,"form-control",3,"placeholder"],[1,"input-group-text",2,"height","46px","cursor","pointer"],["formControlName","color","id","color","resettable","",1,"custom-select",3,"placeholder","data","noResultMessage"],[1,"help-text"],["id","name","type","text","formControlName","speed_max",1,"form-control",3,"placeholder"],[1,"custom-editor"],[3,"editor"],["formControlName","description",3,"editor","ngModel","placeholder"],[1,"invalid-feedback"],["formControlName","brand_id","id","brand_id","resettable","",1,"custom-select",3,"update","placeholder","data","noResultMessage"],["formControlName","model_id","bindLabel","name","bindValue","id","id","model_id","resettable","",1,"custom-select",3,"placeholder","data","noResultMessage"],["formControlName","carburant","id","carburant_id","resettable","",1,"custom-select",3,"placeholder","data","noResultMessage"],["tab","inventory",1,"tab"],["formGroupName","user"],["id","unit","type","text","formControlName","firstname_user",1,"form-control",3,"placeholder"],["formControlName","country_code",1,"custom-select","intl-tel-input",3,"templates","data","noResultMessage"],["type","number","formControlName","phone_user","name","phone",1,"form-control","intl-input-padding",3,"placeholder"],["type","email","name","email","formControlName","email_user",1,"form-control",3,"placeholder"],[1,"form-check","form-switch","ps-0"],[1,"switch"],["type","checkbox","id","is_sale_enable","formControlName","is_young_driver"],[1,"switch-state"],[1,"country"],[1,"flag-box"],[1,"dial-code"],["tab","setup",1,"tab"],["formGroupName","device"],["id","unit","type","text","formControlName","imei",1,"form-control",3,"placeholder"],["type","number","formControlName","phone_device","name","phone",1,"form-control","intl-input-padding",3,"placeholder"],["id","unit","type","text","formControlName","operator",1,"form-control",3,"placeholder"],[3,"selectedItem","position","selectedOption","options"],[3,"label","for","required","labelClass","gridClass"],["type","text","id","address","formControlName","adresse",1,"form-control",3,"placeholder"],["title","\u{1F4CD} Utiliser ma position actuelle",1,"input-group-text",2,"height","46px","cursor","pointer",3,"click"],[1,"ri-crosshair-2-line"],[1,"col-md-3"],[1,"col-md-9"],["height","600px","width","100%",3,"center","zoom","options",4,"ngIf"],["height","600px","width","100%",3,"center","zoom","options"],[3,"mapDragend","position","draggable","options"],["tab","images",1,"tab"],[3,"selectedFiles","multipleImage","image","helpText"],[3,"selectedFiles","multipleImage","images","helpText"],["tab","status",1,"tab"],["formGroupName","notifications"],[4,"ngFor","ngForOf"],["type","checkbox","id","vehicle_featured",3,"change","formControlName"],[2,"width","88%",3,"selectedItem","position","selectedOption","hidden","options"]],template:function(t,i){if(t&1){let r=T();s(0,"form",5),x("ngSubmit",function(){return b(r),C(i.submit())}),s(1,"div",6)(2,"div",7)(3,"div",8)(4,"ul",9,0),Se("activeIdChange",function(f){return b(r),Ie(i.active,f)||(i.active=f),C(f)}),x("activeIdChange",function(f){return b(r),C(i.onTabChange(f))}),s(6,"li",10)(7,"a",11),c(8,"i",12),h(9),p(10,"translate"),n(),g(11,si,44,80,"ng-template",13),n(),s(12,"li",14)(13,"a",11),c(14,"i",15),h(15),p(16,"translate"),n(),g(17,mi,21,35,"ng-template",13),n(),s(18,"li",16)(19,"a",11),c(20,"i",17),h(21),p(22,"translate"),n(),g(23,_i,36,58,"ng-template",13),n(),s(24,"li",18)(25,"a",11),c(26,"i",19),h(27),p(28,"translate"),n(),g(29,gi,10,30,"ng-template",13),n(),s(30,"li",20)(31,"a",11),c(32,"i",21),h(33),p(34,"translate"),n(),g(35,Ci,3,1,"ng-template",13),n()()(),s(36,"div",22),c(37,"div",23),n()(),s(38,"app-button",24),h(39),p(40,"translate"),n()()()}if(t&2){let r=Y(5);l("formGroup",i.form),o(4),Ve("activeId",i.active),o(2),k("is-invalid",i.tabError=="general"),o(3),N(d(10,20,"general")),o(3),k("is-invalid",i.tabError=="inventory"),o(3),N(d(16,22,"driver")),o(3),k("is-invalid",i.tabError=="setup"),o(3),N(d(22,24,"device")),o(3),k("is-invalid",i.tabError=="images"),o(3),N(d(28,26,"images")),o(3),k("is-invalid",i.tabError=="status"),o(3),N(d(34,28,"notifications")),o(4),l("ngbNavOutlet",r),o(),l("id","vehicle_btn"),o(),S(" ",d(40,30,i.type=="create"?"save_vehicle":"update_vehicle")," ")}},dependencies:[Ee,Te,Ke,Ye,Je,He,Ze,Xe,et,Ge,qe,Re,De,Oe,$e,je,Le,ze,ot,at,lt,nt,tt,At,Pt,St,Nt,Fe,Me,ie],styles:["[_nghost-%COMP%]     .ck-editor__editable_inline{min-height:300px!important}.dp-hidden[_ngcontent-%COMP%]{width:0;margin:0;border:none;padding:0}.custom-day[_ngcontent-%COMP%]{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}.custom-day.focused[_ngcontent-%COMP%]{background-color:#e6e6e6}.custom-day.range[_ngcontent-%COMP%], .custom-day[_ngcontent-%COMP%]:hover{background-color:#0da487;color:#fff}.custom-day.faded[_ngcontent-%COMP%]{background-color:#009289}.error-border[_ngcontent-%COMP%]{border:1px solid #f00;padding:3px;border-radius:11px}"]});var w=R;V([I(ee.user)],w.prototype,"user$",void 0);V([I(M.selectedVehicle)],w.prototype,"vehicle$",void 0);V([I(M.vehicles)],w.prototype,"vehicles$",void 0);V([I(re.stores)],w.prototype,"store$",void 0);V([I(se.brands)],w.prototype,"brands$",void 0);V([I(oe.category)],w.prototype,"category$",void 0);V([I(le.tag)],w.prototype,"tag$",void 0);V([I(ne.taxes)],w.prototype,"tax$",void 0);V([I(te.setting)],w.prototype,"setting$",void 0);var $t=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=F({type:e,selectors:[["app-create-vehicle"]],decls:2,vars:3,consts:[[3,"gridClass","title"],[3,"type"]],template:function(r,u){r&1&&(s(0,"app-page-wrapper",0),c(1,"app-form-vehicle",1),n()),r&2&&(l("gridClass","col-sm-12")("title","add_car"),o(),l("type","create"))},dependencies:[O,w]});let a=e;return a})();var Gt=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=F({type:e,selectors:[["app-edit-vehicle"]],decls:2,vars:3,consts:[[3,"gridClass","title"],[3,"type"]],template:function(r,u){r&1&&(s(0,"app-page-wrapper",0),c(1,"app-form-vehicle",1),n()),r&2&&(l("gridClass","col-sm-12")("title","edit_vehicle"),o(),l("type","edit"))},dependencies:[O,w]});let a=e;return a})();var yi=[{path:"",component:G,canActivate:[ae],data:{permission:"vehicle.index"}},{path:"create",component:$t,canActivate:[ae],data:{permission:["vehicle.index","vehicle.create"]}},{path:"edit/:id",component:Gt,canActivate:[ae],data:{permission:["vehicle.index","vehicle.edit"]}}],Rt=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=K({type:e}),e.\u0275inj=W({imports:[ce.forChild(yi),ce]});let a=e;return a})();var Ho=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=K({type:e}),e.\u0275inj=W({imports:[Be,Rt,ut,Dt,Et,Pe.forFeature([M,re,se,z,oe,le,ne,te])]});let a=e;return a})();export{Ho as VehiclesModule};
