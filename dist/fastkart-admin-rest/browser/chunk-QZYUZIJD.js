import{a as de,m as te}from"./chunk-O55BQOZL.js";import{a as ee}from"./chunk-ISOQKGNC.js";import{A as Ne,B as Ue,Bc as Xe,Dc as Ye,E as A,Fa as Qe,G as Me,L as Be,O as Pe,T as Le,Ua as We,a as _,aa as Y,ab as He,ba as qe,ca as Ge,da as Oe,fb as ze,k as j,l as ke,lb as N,m as w,n as Te,o as X,p as q,qb as Je,rb as Ke,x as $e,y as je,z as Ae}from"./chunk-X2K52VJG.js";import{$,Aa as ye,Bc as Ee,C as fe,Ca as s,Da as v,Ia as ge,Ib as J,Nb as f,Nc as Fe,Ob as h,P as he,Pc as K,Q as ve,Qa as I,Qc as Ve,Rb as me,S as y,Sa as l,Sc as pe,Ua as be,Vc as Z,Wa as _e,Y as O,Z as Q,ab as m,bb as p,bc as Ce,c as le,cb as u,da as S,ea as W,gb as H,h as c,j as ce,jb as C,kc as xe,la as g,ma as b,nb as z,nc as De,q as ue,rb as we,sb as Re,tb as Se,ub as L,vc as Ie,wb as x,yb as D}from"./chunk-V4SAOAZP.js";import{a as k,b as T}from"./chunk-CWTPBX7D.js";var E=(()=>{let e=class e{constructor(t){this.payload=t}};e.type="[Reminder] Get";let r=e;return r})(),Ze=(()=>{let e=class e{constructor(t){this.payload=t}};e.type="[Reminder] Value Get";let r=e;return r})(),re=(()=>{let e=class e{constructor(t){this.payload=t}};e.type="[Reminder] Create";let r=e;return r})(),ie=(()=>{let e=class e{constructor(t){this.id=t}};e.type="[Reminder] Edit";let r=e;return r})(),oe=(()=>{let e=class e{constructor(t,i){this.payload=t,this.id=i}};e.type="[Reminder] Update";let r=e;return r})(),et=(()=>{let e=class e{constructor(t,i){this.id=t,this.status=i}};e.type="[Reminder] Update Status";let r=e;return r})(),ne=(()=>{let e=class e{constructor(t){this.id=t}};e.type="[Reminder] Delete";let r=e;return r})(),ae=(()=>{let e=class e{constructor(t){this.ids=t}};e.type="[Reminder] Delete All";let r=e;return r})(),tt=(()=>{let e=class e{constructor(t){this.payload=t}};e.type="[Reminder] Import";let r=e;return r})(),se=(()=>{let e=class e{};e.type="[Reminder] Export";let r=e;return r})();var rt=(()=>{let e=class e{constructor(t){this.http=t}getReminders(t){return this.http.get(`${_.URL}/reminder`,{params:t})}getReminderValues(t){return this.http.get(`${_.URL}/reminder-value`,{params:t})}createReminder(t){return this.http.post(`${_.URL}/reminder`,t)}editReminder(t){return this.http.get(`${_.URL}/reminder/${t}`)}updateReminder(t,i){return this.http.put(`${_.URL}/reminder/${t}`,i)}updateReminderStatus(t,i){return this.http.put(`${_.URL}/reminder/${t}/${i}`,{})}deleteReminder(t){return this.http.delete(`${_.URL}/reminder/${t}`)}deleteAllReminder(t){return this.http.post(`${_.URL}/reminder/deleteAll`,{ids:t})}importReminder(t){let i=new FormData;return Array.isArray(t)&&t.length&&t.forEach((n,a)=>{i.append("reminders",n,n.name)}),this.http.post(`${_.URL}/reminder/csv/import`,i)}exportReminder(){let t={};return this.http.post(`${_.URL}/reminder/csv/export`,t,{responseType:"blob"})}};e.\u0275fac=function(i){return new(i||e)($(Ee))},e.\u0275prov=O({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var R,d=(R=class{constructor(e,o,t){this.store=e,this.notificationService=o,this.reminderService=t}static reminder(e){return e.reminder}static reminders(e){return o=>{let t=Array.from(new Set(o.split(","))).map(Number);return(t.length?e.reminder.data.filter(n=>!t.includes(Number(n.id))):e.reminder.data).map(n=>({label:n?.name,value:n?.id,reminder_values:n?.reminder_values}))}}static reminder_value(e){return o=>o?e?.reminder_values.filter(t=>+t.reminder_id===o)?.map(t=>({label:t?.value,value:t?.id})):[]}static selectedReminder(e){return e.selectedReminder}getReminders(e,o){return this.reminderService.getReminders(o.payload).pipe(y({next:t=>{e.patchState({reminder:{data:t.data,total:t?.total?t?.total:t.data.length}})},error:t=>{throw new Error(t?.error?.message)}}))}getReminderValues(e,o){return this.reminderService.getReminderValues(o.payload).pipe(y({next:t=>{let i=e.getState();e.patchState(T(k({},i),{reminder_values:t.data}))},error:t=>{throw new Error(t?.error?.message)}}))}create(e,o){return this.reminderService.createReminder(o.payload).pipe(y({next:t=>{let i=e.getState();e.patchState(T(k({},i),{reminder:{data:[...i.reminder.data,t],total:i?.reminder.total+1}}))},complete:()=>{this.notificationService.showSuccess("Reminder Created Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}edit(e,{id:o}){return this.reminderService.editReminder(o).pipe(y({next:t=>{let i=e.getState();e.patchState(T(k({},i),{selectedReminder:t}))},error:t=>{throw new Error(t?.error?.message)}}))}update(e,{payload:o,id:t}){return this.reminderService.updateReminder(t,o).pipe(y({next:i=>{if(typeof i=="object"){let n=e.getState(),a=[...n.reminder.data],B=a.findIndex(P=>P.id===t);a[B]=i,e.patchState(T(k({},n),{reminder:{data:a,total:n.reminder.total}}))}},complete:()=>{this.notificationService.showSuccess("Reminder Updated Successfully")},error:i=>{throw new Error(i?.error?.message)}}))}updateStatus(e,{id:o,status:t}){return this.reminderService.updateReminderStatus(o,t).pipe(y({next:i=>{if(typeof i=="object"){let n=e.getState(),a=[...n.reminder.data],B=a.findIndex(P=>P.id===o);a[B]=i,e.patchState(T(k({},n),{reminder:{data:a,total:n.reminder.total}}))}},complete:()=>{this.notificationService.showSuccess("Reminder Status Updated Successfully")},error:i=>{throw new Error(i?.error?.message)}}))}delete(e,{id:o}){return this.reminderService.deleteReminder(o).pipe(y({next:()=>{this.store.dispatch(new E({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Reminder Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}deleteAll(e,{ids:o}){return this.reminderService.deleteAllReminder(o).pipe(y({next:()=>{this.store.dispatch(new E({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Reminder Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}import(e,o){return this.reminderService.importReminder(o.payload).pipe(y({next:t=>{this.store.dispatch(new E({page:1,paginate:15}))},error:t=>{throw new Error(t?.error?.message)}}))}export(e,o){return this.reminderService.exportReminder().pipe(y({next:t=>{let i=new Blob([t],{type:"text/csv"}),n=window.URL.createObjectURL(i),a=document.createElement("a");a.href=n,a.download="reminders.csv",a.click(),window.URL.revokeObjectURL(n)},error:t=>{throw new Error(t?.error?.message)}}))}},R.\u0275fac=function(o){return new(o||R)($(j),$(Qe),$(rt))},R.\u0275prov=O({token:R,factory:R.\u0275fac}),R);c([w(E)],d.prototype,"getReminders",null);c([w(Ze)],d.prototype,"getReminderValues",null);c([w(re)],d.prototype,"create",null);c([w(ie)],d.prototype,"edit",null);c([w(oe)],d.prototype,"update",null);c([w(et)],d.prototype,"updateStatus",null);c([w(ne)],d.prototype,"delete",null);c([w(ae)],d.prototype,"deleteAll",null);c([w(tt)],d.prototype,"import",null);c([w(se)],d.prototype,"export",null);c([q()],d,"reminder",null);c([q()],d,"reminders",null);c([q()],d,"reminder_value",null);c([q()],d,"selectedReminder",null);d=c([Te({name:"reminder",defaults:{reminder:{data:[],total:0},reminder_values:[],selectedReminder:null}})],d);var ct=["csvModal"],ut=()=>["/reminder/create"];function ft(r,e){r&1&&(m(0,"div",5)(1,"a",6),u(2,"i",7),x(3),f(4,"translate"),p()()),r&2&&(s(),l("routerLink",J(4,ut)),s(2),D(" ",h(4,2,"add_reminder")," "))}var U=class U{constructor(e,o){this.store=e,this.router=o,this.tableConfig={columns:[{title:"No.",dataField:"id",type:"no"},{title:"Titre",dataField:"title",sortable:!0,sort_direction:"desc"},{title:"Date",dataField:"date",type:"date",sortable:!0,sort_direction:"desc"},{title:"Vehicle",dataField:"vehicle.title",sortable:!0,sort_direction:"desc"},{title:"User",dataField:"user.name",sortable:!0,sort_direction:"desc"}],rowActions:[{label:"Edit",actionToPerform:"edit",icon:"ri-pencil-line",permission:"vehicle.edit"},{label:"Delete",actionToPerform:"delete",icon:"ri-delete-bin-line",permission:"vehicle.destroy"}],data:[],total:0}}ngOnInit(){this.reminder$.subscribe(e=>{this.tableConfig.data=e?e?.data:[],this.tableConfig.total=e?e?.total:0})}onTableChange(e){this.store.dispatch(new E(e))}onActionClicked(e){e.actionToPerform=="edit"?this.edit(e.data):e.actionToPerform=="delete"?this.delete(e.data):e.actionToPerform=="deleteAll"&&this.deleteAll(e.data)}edit(e){this.router.navigateByUrl(`/reminder/edit/${e.id}`)}delete(e){this.store.dispatch(new ne(e.id))}deleteAll(e){this.store.dispatch(new ae(e))}export(){this.store.dispatch(new se)}};U.\u0275fac=function(o){return new(o||U)(v(j),v(K))},U.\u0275cmp=S({type:U,selectors:[["app-remider"]],viewQuery:function(o,t){if(o&1&&we(ct,5),o&2){let i;Re(i=Se())&&(t.CSVModal=i.first)}},decls:5,vars:6,consts:[["csvModal",""],[3,"gridClass","title"],["class","d-flex flex-wrap gap-2","button","",4,"hasPermission"],[3,"tableChanged","rowClicked","action","tableConfig","hasCheckbox"],[3,"module"],["button","",1,"d-flex","flex-wrap","gap-2"],[1,"align-items-center","btn","btn-theme","d-flex",3,"routerLink"],[1,"ri-add-line"]],template:function(o,t){if(o&1){let i=H();m(0,"app-page-wrapper",1),I(1,ft,5,5,"div",2),m(2,"app-table",3),C("tableChanged",function(a){return g(i),b(t.onTableChange(a))})("rowClicked",function(a){return g(i),b(t.edit(a))})("action",function(a){return g(i),b(t.onActionClicked(a))}),p()(),u(3,"app-import-csv-modal",4,0)}o&2&&(l("gridClass","col-sm-12")("title","remider"),s(),l("hasPermission","vehicle.create"),s(),l("tableConfig",t.tableConfig)("hasCheckbox",!0),s(),l("module","attribute"))},dependencies:[Ve,Je,N,Xe,He,Z]});var G=U;c([X(d.reminder)],G.prototype,"reminder$",void 0);var ht=()=>[];function vt(r,e){if(r&1&&(m(0,"div",24),u(1,"img",25),p(),x(2)),r&2){let o=e.data;s(),_e("img-fluid selection-image"),l("src",o.image,ye),s(),D(" ",o.name," ")}}function yt(r,e){r&1&&(m(0,"div",26),x(1),f(2,"translate"),p()),r&2&&(s(),D(" ",h(2,1,"name_is_required")," "))}function gt(r,e){if(r&1&&(m(0,"span",27),x(1),p()),r&2){let o=e.$implicit,t=e.focused;be("focused",t),s(),D(" ",o.day," ")}}function bt(r,e){r&1&&(m(0,"div",26),x(1),f(2,"translate"),p()),r&2&&(s(),D(" ",h(2,1,"start_date_is_required")," "))}function _t(r){return new Y(r.year,r.month,r.day)}var M=class M{constructor(e,o,t,i,n,a,B,P){this.store=e,this.route=o,this.router=t,this.renderer=i,this.calendar=n,this.formatter=a,this.formBuilder=B,this.document=P,this.search=new le,this.documents=[{value:"",hex_color:"",id:""}],this.destroy$=new le,this.variantStyle=[{value:"rectangle",label:"Rectangle"},{value:"circle",label:"Circle"},{value:"radio",label:"Radio"},{value:"dropdown",label:"Dropdown"},{value:"image",label:"Image"},{value:"color",label:"Color"}],this.form=this.formBuilder.group({title:new A("",[Ae.required]),kilometre:new A("",[]),date:new A(""),selected_vehicles:new A,alert_sms:new A(1)})}get valueControl(){return this.form.get("value")}ngOnInit(){this.store.dispatch(new de({status:1})),this.route.params.pipe(he(e=>e.id?this.store.dispatch(new ie(e.id)).pipe(ue(()=>this.store.select(d.selectedReminder))):ce()),ve(this.destroy$)).subscribe(e=>{console.log("/***** The Value  Array.from(String(reminder.vehicle_id), Number) ****/"),console.log(Array.from(String(e.vehicle_id),Number)),this.id=e?.id,this.fromDate=e?.date?_t(this.formatter.parse(e.date)):null,this.form.patchValue({title:e?.title,kilometre:e?.kilometre,date:e?.date,selected_vehicles:[e.vehicle_id]})}),this.search.pipe(fe(300)).subscribe(e=>{this.store.dispatch(new de({status:1,is_approved:1,paginate:15,search:e})),this.renderer.addClass(this.document.body,"loader-none")})}submit(){this.form.markAllAsTouched();let e=new re(this.form.value);this.type=="edit"&&this.id&&(e=new oe(this.form.value,this.id)),this.form.valid&&this.store.dispatch(e).subscribe({complete:()=>{this.router.navigateByUrl("/reminder")}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onDateSelection(e){this.fromDate=e,this.fromDate&&this.form.controls.date.setValue(`${this.fromDate.year}-${this.fromDate.month}-${this.fromDate.day}`)}validateInput(e,o){let t=this.formatter.parse(o);return t&&this.calendar.isValid(Y.from(t))?Y.from(t):e}productDropdown(e){e.innerSearchText&&this.search.next("")}searchProduct(e){this.search.next(e.search)}};M.\u0275fac=function(o){return new(o||M)(v(j),v(Fe),v(K),v(ge),v(qe),v(Ge),v(Le),v(Ce))},M.\u0275cmp=S({type:M,selectors:[["app-form-remider"]],inputs:{type:"type"},decls:39,vars:54,consts:[["template",""],["datepicker","ngbDatepicker"],["t",""],["dpFromDate",""],[1,"theme-form","theme-form-2","mega-form",3,"ngSubmit","formGroup"],[3,"labelClass","gridClass","label","for","required"],["formControlName","selected_vehicles","id","exclude_product",1,"custom-select",3,"close","search","data","templates","placeholder","noResultMessage","customSearchEnabled","multiple"],[3,"label","for","required"],["type","text","name","name","formControlName","title",1,"form-control",3,"placeholder"],["class","invalid-feedback",4,"ngIf"],["type","text","formControlName","kilometre",1,"form-control",3,"placeholder"],[1,"dp-hidden","position-absolute","custom-dp-dropdown"],[1,"input-group"],["name","datepicker","ngbDatepicker","","outsideDays","hidden","tabindex","-1","readonly","",1,"form-control",3,"dateSelect","autoClose","displayMonths","startDate","dayTemplate"],[1,"input-group","custom-dt-picker"],["placeholder","yyyy-mm-dd","name","dpFromDate","readonly","",1,"form-control",3,"input","value"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"ri-calendar-line"],[1,"form-check","form-switch","ps-0"],[1,"switch"],["type","checkbox","id","is_first_order","formControlName","alert_sms"],[1,"switch-state"],[1,"border-up-class","mt-4"],[3,"id"],[1,"image"],[3,"src"],[1,"invalid-feedback"],[1,"custom-day"]],template:function(o,t){if(o&1){let i=H();m(0,"form",4),C("ngSubmit",function(){return g(i),b(t.submit())}),m(1,"app-form-fields",5)(2,"select2",6),f(3,"translate"),f(4,"async"),f(5,"async"),f(6,"translate"),C("close",function(a){return g(i),b(t.productDropdown(a))})("search",function(a){return g(i),b(t.searchProduct(a))}),I(7,vt,3,4,"ng-template",null,0,me),p()(),m(9,"app-form-fields",7),f(10,"translate"),u(11,"input",8),f(12,"translate"),I(13,yt,3,3,"div",9),p(),m(14,"app-form-fields",7),f(15,"translate"),u(16,"input",10),f(17,"translate"),p(),m(18,"app-form-fields",7)(19,"div",11)(20,"div",12)(21,"input",13,1),C("dateSelect",function(a){return g(i),b(t.onDateSelection(a))}),p(),I(23,gt,2,3,"ng-template",null,2,me),p()(),m(25,"div",14)(26,"input",15,3),C("input",function(){g(i);let a=L(27);return b(t.fromDate=t.validateInput(t.fromDate,a.value))}),p(),m(28,"button",16),C("click",function(){g(i);let a=L(22);return b(a.toggle())}),u(29,"i",17),p()(),I(30,bt,3,3,"div",9),p(),m(31,"app-form-fields",5)(32,"div",18)(33,"label",19),u(34,"input",20)(35,"span",21),p()()(),m(36,"div",22)(37,"app-button",23),x(38),p()()()}if(o&2){let i,n=L(8),a=L(24);l("formGroup",t.form),s(),l("labelClass","form-label-title col-sm-2 mb-0")("gridClass","col-sm-10")("label","vehicles")("for","exclude_product")("required",!1),s(),z("noResultMessage",h(3,37,"no_data_found")),l("data",(i=h(4,39,t.vehicle$))!=null&&i.length?h(5,41,t.vehicle$):J(53,ht))("templates",n)("placeholder",h(6,43,"select_vehicle"))("customSearchEnabled",!0)("multiple",!0),s(7),l("label",h(10,45,"title"))("for","name")("required",!0),s(2),z("placeholder",h(12,47,"enter_title")),s(2),l("ngIf",t.form.controls.title.touched&&(t.form.controls.title.errors==null?null:t.form.controls.title.errors.required)),s(),l("label",h(15,49,"kilometre"))("for","value")("required",!1),s(2),z("placeholder",h(17,51,"kilometre")),s(2),l("label","Date")("for","sale_starts_at")("required",!1),s(3),l("autoClose","outside")("displayMonths",1)("startDate",t.fromDate)("dayTemplate",a),s(5),l("value",t.formatter.format(t.fromDate)),s(4),l("ngIf",(t.form==null||t.form.controls.sale_starts_at==null?null:t.form.controls.sale_starts_at.touched)&&(t.form==null||t.form.controls.sale_starts_at==null||t.form.controls.sale_starts_at.errors==null?null:t.form.controls.sale_starts_at.errors.required)),s(),l("labelClass","form-label-title col-sm-2 mb-0")("gridClass","col-sm-10")("label","alert_sms")("for","is_first_order")("required",!1),s(6),l("id","attribute_btn"),s(),D(" ",t.type=="create"?"Save Reminder":"Update Reminder"," ")}},dependencies:[xe,Oe,Me,je,$e,Ne,Ue,Be,Pe,ze,Ke,We,De,Z]});var V=M;c([X(te.vehicles)],V.prototype,"vehicle$",void 0);var at=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=S({type:e,selectors:[["app-create-remider"]],decls:2,vars:2,consts:[[3,"title"],[3,"type"]],template:function(i,n){i&1&&(m(0,"app-page-wrapper",0),u(1,"app-form-remider",1),p()),i&2&&(l("title","add_reminder"),s(),l("type","create"))},dependencies:[N,V]});let r=e;return r})();var st=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=S({type:e,selectors:[["app-edit-remider"]],decls:2,vars:2,consts:[[3,"title"],[3,"type"]],template:function(i,n){i&1&&(m(0,"app-page-wrapper",0),u(1,"app-form-remider",1),p()),i&2&&(l("title","edit_attribute"),s(),l("type","edit"))},dependencies:[N,V]});let r=e;return r})();var wt=[{path:"",component:G,canActivate:[ee],data:{permission:"vehicle.index"}},{path:"create",component:at,canActivate:[ee],data:{permission:["vehicle.index","vehicle.create"]}},{path:"edit/:id",component:st,canActivate:[ee],data:{permission:["vehicle.index","vehicle.edit"]}}],lt=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=W({type:e}),e.\u0275inj=Q({imports:[pe.forChild(wt),pe]});let r=e;return r})();var xr=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=W({type:e}),e.\u0275inj=Q({imports:[Ie,lt,Ye,ke.forFeature([d,te])]});let r=e;return r})();export{xr as RemiderModule};
