import{a as Se}from"./chunk-XA3FHL27.js";import{a as be,d as A}from"./chunk-YOSF5IMR.js";import{a as ve,h as M}from"./chunk-OOGIV3S4.js";import{a as I}from"./chunk-VTLS4DKO.js";import{a as _e,h as R}from"./chunk-GSBKFZ7D.js";import{a as ye,b as Ce,c as G}from"./chunk-WY6XGZON.js";import{a as W}from"./chunk-NEHVOI7D.js";import{a as Oe}from"./chunk-GF7UNAXA.js";import"./chunk-K5FNPDN3.js";import{Dc as ge,Ga as se,Gb as fe,Mb as j,Zb as V,ab as de,fb as ce,gb as me,k as oe,l as ne,lb as ue,o as C,pb as k,qb as he,va as le}from"./chunk-X2K52VJG.js";import{Ca as o,Da as S,Gb as Z,Ia as Q,Ib as L,Nb as d,Ob as c,Pc as ae,Qa as T,Sa as f,Sc as N,Vc as pe,Wa as H,Z as B,ab as r,bb as a,bc as ee,cb as b,da as q,ea as F,gb as U,h as y,jb as E,kb as w,kc as te,la as $,ma as P,nc as ie,rb as Y,sb as J,tb as K,vc as re,wb as u,xb as h}from"./chunk-V4SAOAZP.js";import"./chunk-CWTPBX7D.js";var z=class{};var Te=["chart"],X=()=>[];function Ee(m,t){if(m&1&&(r(0,"div",11)(1,"div",12)(2,"div",13)(3,"div")(4,"h6"),u(5),d(6,"translate"),a(),r(7,"h3"),u(8),a()(),r(9,"div",14),b(10,"i",15),a()()(),r(11,"div",12)(12,"div",13)(13,"div")(14,"h6"),u(15),d(16,"translate"),a(),r(17,"h3"),u(18),a()(),r(19,"div",14),b(20,"i",16),a()()(),r(21,"div",12)(22,"div",13)(23,"div")(24,"h6"),u(25),d(26,"translate"),a(),r(27,"h3"),u(28),a()(),r(29,"div",14),b(30,"i",17),a()()(),r(31,"div",12)(32,"div",13)(33,"div")(34,"h6"),u(35),d(36,"translate"),a(),r(37,"h3"),u(38),a()(),r(39,"div",14),b(40,"i",18),a()()()()),m&2){let i=w();o(5),h(c(6,8,"total_vehicle")),o(3),h(i.response==null?null:i.response.total_vehicle),o(7),h(c(16,10,"total_geofence")),o(3),h(i.response.total_geofences),o(7),h(c(26,12,"today_trips")),o(3),h(i.response.trips_today),o(7),h(c(36,14,"total_companies")),o(3),h(i.response.nbr_company)}}function Ie(m,t){if(m&1&&(r(0,"div",19)(1,"div",20)(2,"div",13)(3,"div")(4,"h6"),u(5),d(6,"translate"),a(),r(7,"h3"),u(8),d(9,"async"),d(10,"currencySymbol"),a()(),r(11,"div",14),b(12,"i",15),a()()(),r(13,"div",20)(14,"div",13)(15,"div")(16,"h6"),u(17),d(18,"translate"),a(),r(19,"h3"),u(20),d(21,"async"),a()(),r(22,"div",14),b(23,"i",16),a()()(),r(24,"div",20)(25,"div",13)(26,"div")(27,"h6"),u(28),d(29,"translate"),a(),r(30,"h3"),u(31),d(32,"async"),a()(),r(33,"div",14),b(34,"i",17),a()()(),r(35,"div",20)(36,"div",13)(37,"div")(38,"h6"),u(39),d(40,"translate"),a(),r(41,"h3"),u(42),d(43,"async"),a()(),r(44,"div",14),b(45,"i",18),a()()()()),m&2){let i,e,l,p,O=w();o(5),h(c(6,8,"total_revenue")),o(3),h(c(10,12,(i=c(9,10,O.statistics$))==null?null:i.total_revenue)),o(9),h(c(18,14,"total_orders")),o(3),h((e=c(21,16,O.statistics$))==null?null:e.total_orders),o(8),h(c(29,18,"total_product")),o(3),h((l=c(32,20,O.product$))==null?null:l.total),o(8),h(c(40,22,"total_balance")),o(3),h((p=c(43,24,O.user$))==null||p.vendor_wallet==null?null:p.vendor_wallet.balance)}}function De(m,t){if(m&1&&b(0,"apx-chart",8),m&2){let i=w();f("series",i.chartOptionsHistogramme==null?null:i.chartOptionsHistogramme.series)("chart",i.chartOptionsHistogramme==null?null:i.chartOptionsHistogramme.chart)("xaxis",i.chartOptionsHistogramme==null?null:i.chartOptionsHistogramme.xaxis)("yaxis",i.chartOptionsHistogramme==null?null:i.chartOptionsHistogramme.yaxis)("dataLabels",i.chartOptionsHistogramme==null?null:i.chartOptionsHistogramme.dataLabels)("stroke",i.chartOptionsHistogramme==null?null:i.chartOptionsHistogramme.stroke)("title",i.chartOptionsHistogramme==null?null:i.chartOptionsHistogramme.title)("legend",i.chartOptionsHistogramme==null?null:i.chartOptionsHistogramme.legend)("fill",i.chartOptionsHistogramme==null?null:i.chartOptionsHistogramme.fill)("markers",i.chartOptionsHistogramme==null?null:i.chartOptionsHistogramme.markers)("grid",i.chartOptionsHistogramme==null?null:i.chartOptionsHistogramme.grid)}}function Be(m,t){if(m&1){let i=U();r(0,"div",21)(1,"app-page-wrapper",5)(2,"app-table",22),E("tableChanged",function(l){$(i);let p=w();return P(p.onOrderTableChange(l))})("rowClicked",function(l){$(i);let p=w();return P(p.orderView(l))})("action",function(l){$(i);let p=w();return P(p.onOrderActionClicked(l))}),a()()()}if(m&2){let i=w();o(),f("gridClass","col-sm-12")("title","resume_for_each_vehicle"),o(),f("tableConfig",i.orderTableConfig)("loading",!1)("pagination",!1)("topbar",!1)("hasCheckbox",!1)}}var x=class x{constructor(t,i,e,l,p,O,D){this.renderer=t,this.accessDataService=e,this.document=l,this.store=p,this.router=O,this.topProductLoader=!1,this.productStockLoader=!1,this.topSellerLoader=!1,this.response=new z,this.filter=[{value:"today",label:"Today"},{value:"last_week",label:"Last Week"},{value:"last_month",label:"Last Month"},{value:"this_year",label:"This Year"}],this.sellerTableConfig={columns:[{title:"store_name",dataField:"store_name"},{title:"orders",dataField:"orders_count"},{title:"earning",dataField:"order_amount"}],data:[],total:0},this.orderTableConfig={columns:[{title:"Vehicule",dataField:"title_vehicle"},{title:"Status",dataField:"status"},{title:"En Mouvement",dataField:"moving"},{title:"Chauffeur",dataField:"driver_name"},{title:"T\xE9l Chauffeur",dataField:"driver_phone"},{title:"Adresse actuelle",dataField:"current_adresse"},{title:"Vitesse Moy",dataField:"overage_speed",type:"speed"},{title:"Vitesse Max",dataField:"max_speed",type:"speed"},{title:"Nbr Trajet",dataField:"nbr_trips"},{title:"Distance Total",dataField:"distance"},{title:"consommation carburant",dataField:"consomution_fuel",type:"price"}],rowActions:[{label:"View",actionToPerform:"view",icon:"ri-eye-line",permission:"order.edit"}],data:[],total:0},this.productStockTableConfig={columns:[{title:"image",dataField:"product_thumbnail",class:"tbl-image",type:"image",placeholder:"assets/images/product.png"},{title:"name",dataField:"name"},{title:"quantity",dataField:"quantity"},{title:"stock",dataField:"stock"}],rowActions:[{label:"Edit",actionToPerform:"edit",icon:"ri-pencil-line",permission:"product.edit"}],data:[],total:0},i.max=5,i.readonly=!0,this.startDate=this.getWeekRange().start,this.endDate=this.getWeekRange().end,this.chartOptions={series:[{name:"Title vehicle 1",data:[],color:"#0da487"},{name:"Title vehciles 2",data:[],color:"#FFA53B"}],chart:{height:350,type:"line",dropShadow:{enabled:!0,top:10,left:0,blur:3,color:"#720f1e",opacity:.1},zoom:{enabled:!1}},dataLabels:{enabled:!0},markers:{strokeWidth:4,strokeColors:"#ffffff",hover:{size:9}},stroke:{curve:"smooth",lineCap:"butt",width:4},grid:{xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}}},legend:{show:!1},responsive:[{breakpoint:1200,options:{grid:{padding:{right:-95}}}},{breakpoint:992,options:{grid:{padding:{right:-69}}}},{breakpoint:767,options:{chart:{height:200}}},{breakpoint:576,options:{yaxis:{labels:{show:!1}}}}],xaxis:{categories:[],range:void 0,axisBorder:{offsetX:0,show:!1},axisTicks:{show:!1}}},this.chartOptionsCarburant={series:[{name:"Title vehicle 1",data:[],color:"#0da487"},{name:"Title vehciles 2",data:[],color:"#FFA53B"}],chart:{height:350,type:"line",dropShadow:{enabled:!0,top:10,left:0,blur:3,color:"#720f1e",opacity:.1},zoom:{enabled:!1}},dataLabels:{enabled:!0},markers:{strokeWidth:4,strokeColors:"#ffffff",hover:{size:9}},stroke:{curve:"smooth",lineCap:"butt",width:4},grid:{xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}}},legend:{show:!1},responsive:[{breakpoint:1200,options:{grid:{padding:{right:-95}}}},{breakpoint:992,options:{grid:{padding:{right:-69}}}},{breakpoint:767,options:{chart:{height:200}}},{breakpoint:576,options:{yaxis:{labels:{show:!1}}}}],xaxis:{categories:[],range:void 0,axisBorder:{offsetX:0,show:!1},axisTicks:{show:!1}}},this.accessDataService.getData({deviceId:null,from:this.startDate,to:this.endDate},"/traccar/dashboard").subscribe(n=>{if(n){this.response=n;let v=n.nbr_trips_last_week.vehicles,s=[];Object.keys(v).forEach(_=>{s.push({name:_,data:Object.values(v[_]),color:_.split("|")[1]})}),this.chartOptions=this.makeChart("line",s,n.nbr_trips_last_week.axeX),v=n.fuelCost.vehicles,s=[],Object.keys(v).forEach(_=>{s.push({name:_,data:Object.values(v[_]),color:_.split("|")[1]})}),console.log("/***** The Valu seriesseriesseriesseriese ****/"),console.log(s),this.chartOptionsCarburant=this.makeChart("line",s,n.fuelCost.axeX),v=n.histogramVitesse.vehicles,s=[],Object.keys(v).forEach(_=>{console.log("/***** The Value Object.values(vehicles[title]) ****/"),console.log(Object.values(v[_])),s.push({name:_,data:Object.values(v[_])[1],color:_.split("|")[1]})}),console.log("/***** The Value vehicles series,series,****/"),this.chartOptionsHistogramme=this.makeChart("bar",s,n.histogramVitesse.axeX),console.log("response.symaries"),console.log(n.symaries),this.orderTableConfig.data=n.symaries?n.symaries:[],this.orderTableConfig.total=n.symaries.length}},n=>{},()=>{}),this.order$.subscribe(n=>{}),this.order$.subscribe(n=>{let v=n?.data?.filter(s=>(s.order_id=`<span class="fw-bolder">#${s.order_number}</span>`,s.order_payment_status=s.payment_status?`<div class="status-${s.payment_status.toLowerCase()}"><span>${s.payment_status.replace(/_/g," ")}</span></div>`:"-",s.consumer_name=`<span class="text-capitalize">${s?.consumer?.name}</span>`,s));this.orderTableConfig.data=n?v:[],this.orderTableConfig.total=n?n?.total:0}),this.product$.subscribe(n=>{let v=n?.data?.filter(s=>(s.stock=s.stock_status?`<div class="status-${s.stock_status}"><span>${s.stock_status.replace(/_/g," ")}</span></div>`:"-",s));this.productStockTableConfig.data=n?v:[],this.productStockTableConfig.total=n?n?.total:0}),this.store$.subscribe(n=>{this.sellerTableConfig.data=n?n?.data:[],this.sellerTableConfig.total=n?n?.total:0})}makeChart(t,i,e){return console.log("/***** The Value axeX ****/"),console.log(e),{series:i,chart:{height:350,type:t,dropShadow:{enabled:!0,top:10,left:0,blur:3,color:"#720f1e",opacity:.1},zoom:{enabled:!1}},dataLabels:{enabled:!0},markers:{strokeWidth:4,strokeColors:"#ffffff",hover:{size:9}},stroke:{curve:"smooth",lineCap:"butt",width:4},grid:{xaxis:{lines:{show:!0}},yaxis:{lines:{show:!0}}},legend:{show:!0,markers:{width:10,height:10,strokeColor:"#fff",strokeWidth:0,fillColors:void 0},fontSize:"14px",fontWeight:400,itemMargin:{horizontal:10,vertical:5},formatter:function(l,p){return l.split("|")[0]}},responsive:[{breakpoint:1200,options:{grid:{padding:{right:-95}}}},{breakpoint:992,options:{grid:{padding:{right:-69}}}},{breakpoint:767,options:{chart:{height:200}}},{breakpoint:576,options:{yaxis:{labels:{show:!0}}}}],yaxis:{labels:{formatter:function(l){return l.toString()}}},xaxis:{categories:e,range:void 0,axisBorder:{offsetX:0,show:!0},axisTicks:{show:!0}}}}getWeekRange(){let t=new Date,i=new Date(t);i.setDate(t.getDate()-7),i.setHours(0,0,0,0);let e=new Date(t);return e.setDate(t.getDate()),e.setHours(23,59,59,999),{start:i.toISOString(),end:e.toISOString()}}ngOnInit(){this.store.dispatch(new ye),this.store.dispatch(new Ce),this.store.dispatch(new V({status:1,top_selling:1,filter_by:"this_year",paginate:5})),this.store.dispatch(new be({paginate:5})),this.store.dispatch(new _e({status:1,paginate:2})),this.store.dispatch(new fe({type:"product",status:1}))}filterTopProduct(t){this.topProductLoader=!0,this.renderer.addClass(this.document.body,"loader-none");let i={status:1,top_selling:1,filter_by:"this_year",paginate:5};t.value&&(i.filter_by=t.value),this.store.dispatch(new V(i)).subscribe({complete:()=>{this.topProductLoader=!1}})}onOrderTableChange(t){t&&(t.paginate=7),this.store.dispatch(new ve(t))}onOrderActionClicked(t){t.actionToPerform=="view"&&this.orderView(t.data)}orderView(t){this.router.navigateByUrl("/live?deviceID="+t.id)}onProductTableChange(t){t&&(t.paginate=8,t.field="quantity",t.sort="asc"),this.store.dispatch(new V(t)).subscribe({complete:()=>{this.productStockLoader=!1}})}filterProduct(t){this.renderer.addClass(this.document.body,"loader-none");let i={paginate:8,field:"quantity",sort:"asc"};t.value&&(i.category_ids=t.value),this.productStockLoader=!0,this.onProductTableChange(i)}onProductActionClicked(t){t.actionToPerform=="edit"&&this.productEdit(t.data)}productEdit(t){this.router.navigateByUrl(`/product/edit/${t.id}`)}onSellerTableChange(t){t&&!t.filter_by&&(t.paginate=6,t.top_vendor=1,t.filter_by="this_year"),this.store.dispatch(new Oe(t)).subscribe({complete:()=>{this.topSellerLoader=!1}})}filterSeller(t){this.renderer.addClass(this.document.body,"loader-none");let i={paginate:6,top_vendor:1,filter_by:"this_year"};t.value&&(i.filter_by=t.value),this.topSellerLoader=!0,this.onSellerTableChange(i)}redirectToProduct(t){this.router.navigate(["/product/edit",t])}ngOnDestroy(){this.renderer.removeClass(this.document.body,"loader-none")}};x.\u0275fac=function(i){return new(i||x)(S(Q),S(le),S(Se),S(ee),S(oe),S(ae),S(k))},x.\u0275cmp=q({type:x,selectors:[["app-dashboard"]],viewQuery:function(i,e){if(i&1&&Y(Te,5),i&2){let l;J(l=K())&&(e.chart=l.first)}},features:[Z([k])],decls:33,vars:63,consts:[[1,"container-fluid"],[1,"dashboard-tiles"],["class","row g-3",4,"ngIf"],["class","row",4,"ngIf"],[1,"row","m-0"],[3,"gridClass","title"],["button",""],[1,"custom-select","min-w-cls",3,"update","data","placeholder"],[3,"series","chart","xaxis","yaxis","dataLabels","stroke","title","legend","fill","markers","grid"],[3,"series","chart","xaxis","yaxis","dataLabels","stroke","title","legend","fill","markers","grid",4,"ngIf"],["class","col-xl-12 col-md-12 p-0",4,"hasPermission"],[1,"row","g-3"],[1,"col-xl-3","col-sm-6"],[1,"card-tiles"],[1,"icon-box"],[1,"ri-wallet-line"],[1,"ri-file-text-line"],[1,"ri-box-3-line"],[1,"ri-group-line"],[1,"row"],[1,"col-3"],[1,"col-xl-12","col-md-12","p-0"],[3,"tableChanged","rowClicked","action","tableConfig","loading","pagination","topbar","hasCheckbox"]],template:function(i,e){if(i&1&&(r(0,"section"),b(1,"div",0),a(),r(2,"section",1)(3,"div",0),T(4,Ee,41,16,"div",2),d(5,"async"),T(6,Ie,46,26,"div",3),d(7,"async"),a()(),r(8,"section")(9,"div",4)(10,"div"),d(11,"async"),r(12,"app-page-wrapper",5)(13,"div",6)(14,"select2",7),d(15,"translate"),E("update",function(p){return e.filterSeller(p)}),a()(),b(16,"apx-chart",8),a()(),r(17,"div"),d(18,"async"),r(19,"app-page-wrapper",5)(20,"div",6)(21,"select2",7),d(22,"translate"),E("update",function(p){return e.filterSeller(p)}),a()(),T(23,De,1,11,"apx-chart",9),a()(),r(24,"div"),d(25,"async"),r(26,"app-page-wrapper",5)(27,"div",6)(28,"select2",7),d(29,"translate"),E("update",function(p){return e.filterSeller(p)}),a()(),b(30,"apx-chart",8),a()()(),r(31,"div",4),T(32,Be,3,7,"div",10),a()()),i&2){let l,p,O,D,n;o(4),f("ngIf",((l=c(5,44,e.user$))==null||l.role==null?null:l.role.name)!=="vendor"),o(2),f("ngIf",((p=c(7,46,e.user$))==null||p.role==null?null:p.role.name)==="vendor"),o(4),H((((O=c(11,48,e.user$))==null||O.role==null?null:O.role.name)==="vendor","col-xl-12 col-md-12 p-0")),o(2),f("gridClass","col-sm-12")("title","nbr_trajets_per_vehicle"),o(2),f("data",e.filter!=null&&e.filter.length?e.filter:L(60,X))("placeholder",c(15,50,"filter_by")),o(2),f("series",e.chartOptions==null?null:e.chartOptions.series)("chart",e.chartOptions==null?null:e.chartOptions.chart)("xaxis",e.chartOptions==null?null:e.chartOptions.xaxis)("yaxis",e.chartOptions==null?null:e.chartOptions.yaxis)("dataLabels",e.chartOptions==null?null:e.chartOptions.dataLabels)("stroke",e.chartOptions==null?null:e.chartOptions.stroke)("title",e.chartOptions==null?null:e.chartOptions.title)("legend",e.chartOptions==null?null:e.chartOptions.legend)("fill",e.chartOptions==null?null:e.chartOptions.fill)("markers",e.chartOptions==null?null:e.chartOptions.markers)("grid",e.chartOptions==null?null:e.chartOptions.grid),o(),H((((D=c(18,52,e.user$))==null||D.role==null?null:D.role.name)==="vendor","col-xl-12 col-md-12 p-0")),o(2),f("gridClass","col-sm-12")("title","histogramme_vitesse"),o(2),f("data",e.filter!=null&&e.filter.length?e.filter:L(61,X))("placeholder",c(22,54,"filter_by")),o(2),f("ngIf",e.chartOptionsHistogramme),o(),H((((n=c(25,56,e.user$))==null||n.role==null?null:n.role.name)==="vendor","col-xl-12 col-md-12 p-0")),o(2),f("gridClass","col-sm-12")("title","consommation_carburant"),o(2),f("data",e.filter!=null&&e.filter.length?e.filter:L(62,X))("placeholder",c(29,58,"filter_by")),o(2),f("series",e.chartOptionsCarburant==null?null:e.chartOptionsCarburant.series)("chart",e.chartOptionsCarburant==null?null:e.chartOptionsCarburant.chart)("xaxis",e.chartOptionsCarburant==null?null:e.chartOptionsCarburant.xaxis)("yaxis",e.chartOptionsCarburant==null?null:e.chartOptionsCarburant.yaxis)("dataLabels",e.chartOptionsCarburant==null?null:e.chartOptionsCarburant.dataLabels)("stroke",e.chartOptionsCarburant==null?null:e.chartOptionsCarburant.stroke)("title",e.chartOptionsCarburant==null?null:e.chartOptionsCarburant.title)("legend",e.chartOptionsCarburant==null?null:e.chartOptionsCarburant.legend)("fill",e.chartOptionsCarburant==null?null:e.chartOptionsCarburant.fill)("markers",e.chartOptionsCarburant==null?null:e.chartOptionsCarburant.markers)("grid",e.chartOptionsCarburant==null?null:e.chartOptionsCarburant.grid),o(2),f("hasPermission","order.index")}},dependencies:[te,ce,me,he,ue,de,ie,pe,k]});var g=x;y([C(G.statistics)],g.prototype,"statistics$",void 0);y([C(G.revenueChart)],g.prototype,"revenueChart$",void 0);y([C(M.order)],g.prototype,"order$",void 0);y([C(I.product)],g.prototype,"product$",void 0);y([C(I.topSellingProducts)],g.prototype,"topProduct$",void 0);y([C(A.review)],g.prototype,"review$",void 0);y([C(R.blog)],g.prototype,"blog$",void 0);y([C(j.categories)],g.prototype,"category$",void 0);y([C(W.store)],g.prototype,"store$",void 0);y([C(se.user)],g.prototype,"user$",void 0);var Fe=[{path:"",component:g}],ke=(()=>{let t=class t{};t.\u0275fac=function(l){return new(l||t)},t.\u0275mod=F({type:t}),t.\u0275inj=B({imports:[N.forChild(Fe),N]});let m=t;return m})();var Tt=(()=>{let t=class t{};t.\u0275fac=function(l){return new(l||t)},t.\u0275mod=F({type:t}),t.\u0275inj=B({imports:[re,ke,ge,ne.forFeature([I,M,A,R,j,W])]});let m=t;return m})();export{Tt as DashboardModule};
