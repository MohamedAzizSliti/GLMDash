import{Fa as b,a as n,cb as $,k as x,m as h,n as U,p as y}from"./chunk-X2K52VJG.js";import{$ as S,Bc as w,S as p,Y as g,h as o}from"./chunk-V4SAOAZP.js";import{a as d,b as v}from"./chunk-CWTPBX7D.js";var m=(()=>{let e=class e{constructor(t){this.payload=t}};e.type="[Vehicle] Get";let i=e;return i})(),R=(()=>{let e=class e{constructor(t){this.payload=t}};e.type="[Vehicle] Create";let i=e;return i})(),E=(()=>{let e=class e{constructor(t){this.id=t}};e.type="[Vehicle] Edit";let i=e;return i})(),L=(()=>{let e=class e{constructor(t,r){this.payload=t,this.id=r}};e.type="[Vehicle] Update";let i=e;return i})(),j=(()=>{let e=class e{constructor(t,r){this.id=t,this.status=r}};e.type="[Vehicle] Update Status";let i=e;return i})(),A=(()=>{let e=class e{constructor(t,r){this.id=t,this.status=r}};e.type="[Vehicle] Approve Status";let i=e;return i})(),I=(()=>{let e=class e{constructor(t){this.id=t}};e.type="[Vehicle] Delete";let i=e;return i})(),k=(()=>{let e=class e{constructor(t){this.ids=t}};e.type="[Vehicle] Delete All";let i=e;return i})(),D=(()=>{let e=class e{constructor(t){this.ids=t}};e.type="[Vehicle] Replicate";let i=e;return i})(),B=(()=>{let e=class e{constructor(t){this.payload=t}};e.type="[Vehicle] Import";let i=e;return i})(),C=(()=>{let e=class e{};e.type="[Vehicle] Export";let i=e;return i})(),F=(()=>{let e=class e{constructor(t){this.id=t}};e.type="[Vehicle] SelectVehicule";let i=e;return i})();var O=(()=>{let e=class e{constructor(t){this.http=t}getVehicles(t){return this.http.get(`${n.URL}/vehicle`,{params:t})}createVehicle(t){return this.http.post(`${n.URL}/vehicle`,t)}editVehicle(t){return this.http.get(`${n.URL}/vehicle/${t}`)}updateVehicle(t,r){return this.http.put(`${n.URL}/vehicle/${t}`,r)}updateVehicleStatus(t,r){return this.http.put(`${n.URL}/vehicle/${t}/${r}`,{})}approveVehicleStatus(t,r){return this.http.put(`${n.URL}/vehicle/approve/${t}/${r}`,{})}deleteVehicle(t){return this.http.delete(`${n.URL}/vehicle/${t}`)}deleteAllVehicle(t){return this.http.post(`${n.URL}/vehicle/deleteAll`,{ids:t})}replicateVehicle(t){return this.http.post(`${n.URL}/vehicle/replicate`,{ids:t})}importVehicle(t){let r=new FormData;return Array.isArray(t)&&t.length&&t.forEach((l,a)=>{r.append("vehicles",l,l.name)}),this.http.post(`${n.URL}/vehicle/csv/import`,r)}exportVehicle(){let t={};return this.http.post(`${n.URL}/vehicle/csv/export`,t,{responseType:"blob"})}};e.\u0275fac=function(r){return new(r||e)(S(w))},e.\u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var u,s=(u=class{constructor(e,c,t){this.store=e,this.notificationService=c,this.vehicleService=t}static vehicle(e){return e.vehicle}static vehicles(e){return e.vehicle.data.map(c=>({label:c?.title,value:c?.id,data:{id:c.id,type:c.description,name:c.title,brand_is:c.brand_id,device:c.device,slug:c.model_id,stock_status:c.brand_id,image:c.vehicle_thumbnail?c.vehicle_thumbnail.original_url:"assets/images/vehicle.png"}}))}static selectedVehicle(e){return e.selectedVehicle}static topSellingVehicle(e){return e.topSellingVehicles}getVehicles(e,c){return this.vehicleService.getVehicles(c.payload).pipe(p({next:t=>{if(c?.payload.top_selling){let r=e.getState();e.patchState(v(d({},r),{topSellingVehicles:t.data}))}else e.patchState({vehicle:{data:t.data,total:t?.total?t?.total:t.data?.length}})},error:t=>{throw new Error(t?.error?.message)}}))}selectVehicule(e,c){let t=e.getState(),r=t.vehicle.data.find(l=>l.id===c.id)||null;e.patchState(v(d({},t),{selectedVehicle:r}))}create(e,c){return this.vehicleService.createVehicle(c.payload).pipe(p({next:t=>{let r=e.getState();e.patchState(v(d({},r),{vehicle:{data:[...r.vehicle.data,t],total:r?.vehicle.total+1}}))},complete:()=>{this.notificationService.showSuccess("Vehicle Created Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}edit(e,{id:c}){return this.vehicleService.editVehicle(c).pipe(p({next:t=>{let r=e.getState();e.patchState(v(d({},r),{selectedVehicle:t}))},error:t=>{throw new Error(t?.error?.message)}}))}update(e,{payload:c,id:t}){return this.vehicleService.updateVehicle(t,c).pipe(p({next:r=>{if(typeof r=="object"){let l=e.getState(),a=[...l.vehicle.data],V=a.findIndex(f=>f.id===t);a[V]=r,e.patchState(v(d({},l),{vehicle:{data:a,total:l.vehicle.total}}))}},complete:()=>{this.notificationService.showSuccess("Vehicle Updated Successfully")},error:r=>{throw new Error(r?.error?.message)}}))}updateStatus(e,{id:c,status:t}){return this.vehicleService.updateVehicleStatus(c,t).pipe(p({next:r=>{if(typeof r=="object"){let l=e.getState(),a=[...l.vehicle.data],V=a.findIndex(f=>f.id===c);a[V]=r,e.patchState(v(d({},l),{vehicle:{data:a,total:l.vehicle.total}}))}},complete:()=>{this.notificationService.showSuccess("Vehicle Status Updated Successfully")},error:r=>{throw new Error(r?.error?.message)}}))}approveStatus(e,{id:c,status:t}){return this.vehicleService.approveVehicleStatus(c,t).pipe(p({next:r=>{if(typeof r=="object"){let l=e.getState(),a=[...l.vehicle.data],V=a.findIndex(f=>f.id===c);a[V]=r,e.patchState(v(d({},l),{vehicle:{data:a,total:l.vehicle.total}})),this.store.dispatch(new $("/vehicle",r?.total_in_approved_vehicles))}},complete:()=>{this.notificationService.showSuccess("Vehicle Status Updated Successfully")},error:r=>{throw new Error(r?.error?.message)}}))}delete(e,{id:c}){return this.vehicleService.deleteVehicle(c).pipe(p({next:()=>{this.store.dispatch(new m({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Vehicle Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}deleteAll(e,{ids:c}){return this.vehicleService.deleteAllVehicle(c).pipe(p({next:()=>{this.store.dispatch(new m({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Vehicle Deleted Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}replicateVehicle(e,{ids:c}){return this.vehicleService.replicateVehicle(c).pipe(p({next:()=>{this.store.dispatch(new m({page:1,paginate:15}))},complete:()=>{this.notificationService.showSuccess("Vehicle Replicated Successfully")},error:t=>{throw new Error(t?.error?.message)}}))}import(e,c){return this.vehicleService.importVehicle(c.payload).pipe(p({next:t=>{this.store.dispatch(new m({page:1,paginate:15}))},error:t=>{throw new Error(t?.error?.message)}}))}export(e,c){return this.vehicleService.exportVehicle().pipe(p({next:t=>{let r=new Blob([t],{type:"text/xlsx"}),l=window.URL.createObjectURL(r),a=document.createElement("a");a.href=l,a.download="vehicles.xlsx",a.click(),window.URL.revokeObjectURL(l)},error:t=>{throw new Error(t?.error?.message)}}))}},u.\u0275fac=function(c){return new(c||u)(S(x),S(b),S(O))},u.\u0275prov=g({token:u,factory:u.\u0275fac}),u);o([h(m)],s.prototype,"getVehicles",null);o([h(F)],s.prototype,"selectVehicule",null);o([h(R)],s.prototype,"create",null);o([h(E)],s.prototype,"edit",null);o([h(L)],s.prototype,"update",null);o([h(j)],s.prototype,"updateStatus",null);o([h(A)],s.prototype,"approveStatus",null);o([h(I)],s.prototype,"delete",null);o([h(k)],s.prototype,"deleteAll",null);o([h(D)],s.prototype,"replicateVehicle",null);o([h(B)],s.prototype,"import",null);o([h(C)],s.prototype,"export",null);o([y()],s,"vehicle",null);o([y()],s,"vehicles",null);o([y()],s,"selectedVehicle",null);o([y()],s,"topSellingVehicle",null);s=o([U({name:"vehicle",defaults:{vehicle:{data:[],total:0},selectedVehicle:null,topSellingVehicles:[]}})],s);export{m as a,R as b,E as c,L as d,j as e,A as f,I as g,k as h,D as i,C as j,F as k,O as l,s as m};
